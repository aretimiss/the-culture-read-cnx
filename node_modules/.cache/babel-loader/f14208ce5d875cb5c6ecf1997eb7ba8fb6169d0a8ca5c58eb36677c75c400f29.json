{"ast":null,"code":"// src/lib/omekaClient.js\nimport axios from \"axios\";\n\n/** ========= ENV (รองรับ Vite/CRA) ========= */\nconst isVite = typeof import.meta !== \"undefined\" && import.meta.env;\nconst RAW_BASE = (isVite ? import.meta.env.VITE_API_BASE_URL : process.env.REACT_APP_API_BASE_URL) || \"\";\nconst KEY_ID = (isVite ? import.meta.env.VITE_API_KEY_IDENTITY : process.env.REACT_APP_API_KEY_IDENTITY) || \"\";\nconst KEY_CRED = (isVite ? import.meta.env.VITE_API_KEY_CREDENTIAL : process.env.REACT_APP_API_KEY_CREDENTIAL) || \"\";\nconst BASE_URL = RAW_BASE.trim().replace(/\\/+$/, \"\");\n\n/** ========= Assert ========= */\nfunction assertEnv() {\n  if (!BASE_URL) throw new Error(\"Missing API base URL (.env)\");\n  if (!KEY_ID || !KEY_CRED) throw new Error(\"Missing API keys (.env)\");\n}\n\n/** ========= URL helpers ========= */\nexport const api = path => {\n  assertEnv();\n  const clean = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${BASE_URL}${clean}`;\n};\nexport const withKeys = url => {\n  assertEnv();\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\n  return `${url}${sep}key_identity=${encodeURIComponent(KEY_ID)}&key_credential=${encodeURIComponent(KEY_CRED)}`;\n};\n\n/** ========= Axios instance + lightweight cache ========= */\nconst http = axios.create({\n  timeout: 8000,\n  headers: {\n    Accept: \"application/json\"\n  }\n});\n\n// in-memory cache (URL -> { t, data })\nconst cache = new Map();\nconst now = () => Date.now();\n\n/** ========= Query-string builder (รองรับ array/object/property[]) ========= */\nfunction buildQuery(obj = {}) {\n  const pairs = [];\n  const enc = v => encodeURIComponent(String(v));\n  Object.entries(obj).forEach(([k, v]) => {\n    if (v === undefined || v === null || v === \"\") return;\n    if (Array.isArray(v)) {\n      v.forEach((val, idx) => {\n        if (val && typeof val === \"object\" && !Array.isArray(val)) {\n          Object.entries(val).forEach(([sk, sv]) => {\n            if (sv === undefined || sv === null) return;\n            pairs.push(`${enc(k)}[${idx}][${enc(sk)}]=${enc(sv)}`);\n          });\n        } else {\n          pairs.push(`${enc(k)}[]=${enc(val)}`);\n        }\n      });\n      return;\n    }\n    if (typeof v === \"object\") {\n      Object.entries(v).forEach(([sk, sv]) => {\n        if (sv === undefined || sv === null) return;\n        pairs.push(`${enc(k)}[${enc(sk)}]=${enc(sv)}`);\n      });\n      return;\n    }\n    pairs.push(`${enc(k)}=${enc(v)}`);\n  });\n  return pairs.join(\"&\");\n}\n\n/** GET with cache + graceful CORS fallbacks */\nasync function getJson(url, {\n  cacheTtlMs = 30000\n} = {}) {\n  const hit = cache.get(url);\n  if (hit && now() - hit.t < cacheTtlMs) return hit.data;\n  try {\n    const r = await http.get(url);\n    cache.set(url, {\n      t: now(),\n      data: r.data\n    });\n    return r.data;\n  } catch (e1) {\n    try {\n      var _r2$data;\n      const via = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\n      const r2 = await http.get(via);\n      const data = typeof ((_r2$data = r2.data) === null || _r2$data === void 0 ? void 0 : _r2$data.contents) === \"string\" ? JSON.parse(r2.data.contents) : r2.data;\n      cache.set(url, {\n        t: now(),\n        data\n      });\n      return data;\n    } catch (e2) {\n      const via2 = `https://api.codetabs.com/v1/proxy/?quest=${encodeURIComponent(url)}`;\n      const r3 = await http.get(via2);\n      cache.set(url, {\n        t: now(),\n        data: r3.data\n      });\n      return r3.data;\n    }\n  }\n}\n\n/** ========= Public fetchers (เบา) ========= */\n/**\r\n * ดึง items แบบเบา: จำกัดจำนวน/เรียงลำดับ + กรอง has_media=1\r\n * รองรับพารามิเตอร์กรองเพิ่ม เช่น resource_class_label, \"o:resource_class\", item_set_id, property[]\r\n */\nexport async function fetchItemsLite({\n  limit = 12,\n  page = 1,\n  sortBy = \"created\",\n  sortOrder = \"desc\",\n  query,\n  ...restFilters\n} = {}) {\n  let base = `/items?per_page=${encodeURIComponent(limit)}` + `&page=${encodeURIComponent(page)}` + `&sort_by=${encodeURIComponent(sortBy)}` + `&sort_order=${encodeURIComponent(sortOrder)}` + `&has_media=1`;\n  if (query && query.trim()) {\n    const q = query.trim();\n    base += `&${buildQuery({\n      property: [{\n        property: \"dcterms:title\",\n        type: \"contains\",\n        text: q\n      }, {\n        property: \"dcterms:description\",\n        type: \"contains\",\n        text: q\n      }]\n    })}`;\n  }\n  if (restFilters && Object.keys(restFilters).length > 0) {\n    base += `&${buildQuery(restFilters)}`;\n  }\n  const url = withKeys(api(base));\n  return await getJson(url, {\n    cacheTtlMs: 30000\n  });\n}\n\n/** อ่าน media ของ item เฉพาะเมื่อจำเป็น (lazy) */\nexport async function fetchMediaForItem(itemId, {\n  cacheTtlMs = 60000\n} = {}) {\n  const url = withKeys(api(`/media?item_id=${encodeURIComponent(itemId)}`));\n  return await getJson(url, {\n    cacheTtlMs\n  });\n}\n\n/** หา URL PDF (ยังคงไว้สำหรับปุ่ม “เปิดอ่าน”) */\nexport async function pdfUrlOf(item) {\n  const medias = Array.isArray(item === null || item === void 0 ? void 0 : item[\"o:media\"]) ? item[\"o:media\"] : [];\n  for (const m of medias) {\n    const type = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n    const direct = (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || (m === null || m === void 0 ? void 0 : m[\"o:source\"]);\n    if (type.includes(\"pdf\") && direct) return direct;\n  }\n  if (medias.length) {\n    for (const ref of medias) {\n      const refId = ref === null || ref === void 0 ? void 0 : ref[\"@id\"];\n      if (!refId) continue;\n      const url = withKeys(refId);\n      try {\n        const m = await getJson(url, {\n          cacheTtlMs: 60000\n        });\n        const type = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n        if (type.includes(\"pdf\")) {\n          return (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || (m === null || m === void 0 ? void 0 : m[\"o:source\"]) || null;\n        }\n      } catch {}\n    }\n  }\n  const id = item === null || item === void 0 ? void 0 : item[\"o:id\"];\n  if (!id) return null;\n  const list = await fetchMediaForItem(id);\n  const pdf = (Array.isArray(list) ? list : []).find(m => ((m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\").includes(\"application/pdf\"));\n  return (pdf === null || pdf === void 0 ? void 0 : pdf[\"o:original_url\"]) || (pdf === null || pdf === void 0 ? void 0 : pdf[\"o:source\"]) || null;\n}\n\n/** เปิด PDF */\nexport async function openPDFOf(item) {\n  const url = await pdfUrlOf(item);\n  if (!url) throw new Error(\"ไม่พบไฟล์ PDF\");\n  window.open(url, \"_blank\", \"noopener,noreferrer\");\n}\n\n/** ========= ตัวช่วยดึงรูปปกจาก API (รองรับ thumbnail_display_urls) ========= */\nconst thumbCache = new Map();\n\n/**\r\n * คืน URL ปกของ item:\r\n * 1) item.thumbnail_display_urls (medium > large > square > original)\r\n * 2) media ที่ฝังมาและเป็น image + thumbnail_display_urls\r\n * 3) media เป็น @id → ดึงรายละเอียดก่อนแล้วเลือกเหมาะสุด\r\n */\nexport async function thumbUrlOf(item) {\n  const itemId = item === null || item === void 0 ? void 0 : item[\"o:id\"];\n  if (!itemId) return null;\n  if (thumbCache.has(itemId)) return thumbCache.get(itemId);\n\n  // (1) item-level thumbnails\n  const itThumb = item === null || item === void 0 ? void 0 : item.thumbnail_display_urls;\n  if (itThumb) {\n    const best = itThumb.medium || itThumb.large || itThumb.square || itThumb.original || null;\n    if (best) {\n      thumbCache.set(itemId, best);\n      return best;\n    }\n  }\n\n  // (2) media ฝังมา\n  const medias = Array.isArray(item === null || item === void 0 ? void 0 : item[\"o:media\"]) ? item[\"o:media\"] : [];\n  for (const m of medias) {\n    const mt = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n    const t = m === null || m === void 0 ? void 0 : m.thumbnail_display_urls;\n    if (mt.startsWith(\"image/\") && t) {\n      const best = t.medium || t.large || t.square || (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || null;\n      if (best) {\n        thumbCache.set(itemId, best);\n        return best;\n      }\n    }\n  }\n\n  // (3) media เป็นลิงก์ @id → ดึงรายละเอียด\n  for (const ref of medias) {\n    const refId = ref === null || ref === void 0 ? void 0 : ref[\"@id\"];\n    if (!refId) continue;\n    try {\n      const m = await getJson(withKeys(refId), {\n        cacheTtlMs: 60000\n      });\n      const mt = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n      const t = m === null || m === void 0 ? void 0 : m.thumbnail_display_urls;\n      const best = (t === null || t === void 0 ? void 0 : t.medium) || (t === null || t === void 0 ? void 0 : t.large) || (t === null || t === void 0 ? void 0 : t.square) || (mt.startsWith(\"image/\") ? m === null || m === void 0 ? void 0 : m[\"o:original_url\"] : null) || null;\n      if (best) {\n        thumbCache.set(itemId, best);\n        return best;\n      }\n    } catch {}\n  }\n  thumbCache.set(itemId, null);\n  return null;\n}\n\n/** ========= โปรเปอร์ตีทั่วไป ========= */\nexport const titleOf = it => {\n  var _it$dctermsTitle, _it$dctermsTitle$;\n  return (it === null || it === void 0 ? void 0 : it[\"o:title\"]) || (it === null || it === void 0 ? void 0 : (_it$dctermsTitle = it[\"dcterms:title\"]) === null || _it$dctermsTitle === void 0 ? void 0 : (_it$dctermsTitle$ = _it$dctermsTitle[0]) === null || _it$dctermsTitle$ === void 0 ? void 0 : _it$dctermsTitle$[\"@value\"]) || `#${(it === null || it === void 0 ? void 0 : it[\"o:id\"]) || \"\"}`;\n};\nexport const descOf = it => {\n  var _it$dctermsDescripti, _it$dctermsDescripti$;\n  return (it === null || it === void 0 ? void 0 : (_it$dctermsDescripti = it[\"dcterms:description\"]) === null || _it$dctermsDescripti === void 0 ? void 0 : (_it$dctermsDescripti$ = _it$dctermsDescripti[0]) === null || _it$dctermsDescripti$ === void 0 ? void 0 : _it$dctermsDescripti$[\"@value\"]) || \"\";\n};\n\n/** ========= export fetch แบบเดิมเพื่อความเข้ากันได้ ========= */\nexport const fetchJsonWithProxies = async finalUrl => getJson(finalUrl, {\n  cacheTtlMs: 30000\n});","map":{"version":3,"names":["axios","isVite","import","meta","env","RAW_BASE","VITE_API_BASE_URL","process","REACT_APP_API_BASE_URL","KEY_ID","VITE_API_KEY_IDENTITY","REACT_APP_API_KEY_IDENTITY","KEY_CRED","VITE_API_KEY_CREDENTIAL","REACT_APP_API_KEY_CREDENTIAL","BASE_URL","trim","replace","assertEnv","Error","api","path","clean","startsWith","withKeys","url","sep","includes","encodeURIComponent","http","create","timeout","headers","Accept","cache","Map","now","Date","buildQuery","obj","pairs","enc","v","String","Object","entries","forEach","k","undefined","Array","isArray","val","idx","sk","sv","push","join","getJson","cacheTtlMs","hit","get","t","data","r","set","e1","_r2$data","via","r2","contents","JSON","parse","e2","via2","r3","fetchItemsLite","limit","page","sortBy","sortOrder","query","restFilters","base","q","property","type","text","keys","length","fetchMediaForItem","itemId","pdfUrlOf","item","medias","m","direct","ref","refId","id","list","pdf","find","openPDFOf","window","open","thumbCache","thumbUrlOf","has","itThumb","thumbnail_display_urls","best","medium","large","square","original","mt","titleOf","it","_it$dctermsTitle","_it$dctermsTitle$","descOf","_it$dctermsDescripti","_it$dctermsDescripti$","fetchJsonWithProxies","finalUrl"],"sources":["C:/Users/Asus/Desktop/the-culture-read-cnx/src/lib/omekaClient.js"],"sourcesContent":["// src/lib/omekaClient.js\r\nimport axios from \"axios\";\r\n\r\n/** ========= ENV (รองรับ Vite/CRA) ========= */\r\nconst isVite = typeof import.meta !== \"undefined\" && import.meta.env;\r\nconst RAW_BASE =\r\n  (isVite ? import.meta.env.VITE_API_BASE_URL : process.env.REACT_APP_API_BASE_URL) || \"\";\r\nconst KEY_ID =\r\n  (isVite ? import.meta.env.VITE_API_KEY_IDENTITY : process.env.REACT_APP_API_KEY_IDENTITY) || \"\";\r\nconst KEY_CRED =\r\n  (isVite ? import.meta.env.VITE_API_KEY_CREDENTIAL : process.env.REACT_APP_API_KEY_CREDENTIAL) || \"\";\r\nconst BASE_URL = RAW_BASE.trim().replace(/\\/+$/, \"\");\r\n\r\n/** ========= Assert ========= */\r\nfunction assertEnv() {\r\n  if (!BASE_URL) throw new Error(\"Missing API base URL (.env)\");\r\n  if (!KEY_ID || !KEY_CRED) throw new Error(\"Missing API keys (.env)\");\r\n}\r\n\r\n/** ========= URL helpers ========= */\r\nexport const api = (path) => {\r\n  assertEnv();\r\n  const clean = path.startsWith(\"/\") ? path : `/${path}`;\r\n  return `${BASE_URL}${clean}`;\r\n};\r\n\r\nexport const withKeys = (url) => {\r\n  assertEnv();\r\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\r\n  return `${url}${sep}key_identity=${encodeURIComponent(KEY_ID)}&key_credential=${encodeURIComponent(\r\n    KEY_CRED\r\n  )}`;\r\n};\r\n\r\n/** ========= Axios instance + lightweight cache ========= */\r\nconst http = axios.create({\r\n  timeout: 8000,\r\n  headers: { Accept: \"application/json\" },\r\n});\r\n\r\n// in-memory cache (URL -> { t, data })\r\nconst cache = new Map();\r\nconst now = () => Date.now();\r\n\r\n/** ========= Query-string builder (รองรับ array/object/property[]) ========= */\r\nfunction buildQuery(obj = {}) {\r\n  const pairs = [];\r\n  const enc = (v) => encodeURIComponent(String(v));\r\n\r\n  Object.entries(obj).forEach(([k, v]) => {\r\n    if (v === undefined || v === null || v === \"\") return;\r\n\r\n    if (Array.isArray(v)) {\r\n      v.forEach((val, idx) => {\r\n        if (val && typeof val === \"object\" && !Array.isArray(val)) {\r\n          Object.entries(val).forEach(([sk, sv]) => {\r\n            if (sv === undefined || sv === null) return;\r\n            pairs.push(`${enc(k)}[${idx}][${enc(sk)}]=${enc(sv)}`);\r\n          });\r\n        } else {\r\n          pairs.push(`${enc(k)}[]=${enc(val)}`);\r\n        }\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (typeof v === \"object\") {\r\n      Object.entries(v).forEach(([sk, sv]) => {\r\n        if (sv === undefined || sv === null) return;\r\n        pairs.push(`${enc(k)}[${enc(sk)}]=${enc(sv)}`);\r\n      });\r\n      return;\r\n    }\r\n\r\n    pairs.push(`${enc(k)}=${enc(v)}`);\r\n  });\r\n\r\n  return pairs.join(\"&\");\r\n}\r\n\r\n/** GET with cache + graceful CORS fallbacks */\r\nasync function getJson(url, { cacheTtlMs = 30000 } = {}) {\r\n  const hit = cache.get(url);\r\n  if (hit && now() - hit.t < cacheTtlMs) return hit.data;\r\n\r\n  try {\r\n    const r = await http.get(url);\r\n    cache.set(url, { t: now(), data: r.data });\r\n    return r.data;\r\n  } catch (e1) {\r\n    try {\r\n      const via = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\r\n      const r2 = await http.get(via);\r\n      const data =\r\n        typeof r2.data?.contents === \"string\" ? JSON.parse(r2.data.contents) : r2.data;\r\n      cache.set(url, { t: now(), data });\r\n      return data;\r\n    } catch (e2) {\r\n      const via2 = `https://api.codetabs.com/v1/proxy/?quest=${encodeURIComponent(url)}`;\r\n      const r3 = await http.get(via2);\r\n      cache.set(url, { t: now(), data: r3.data });\r\n      return r3.data;\r\n    }\r\n  }\r\n}\r\n\r\n/** ========= Public fetchers (เบา) ========= */\r\n/**\r\n * ดึง items แบบเบา: จำกัดจำนวน/เรียงลำดับ + กรอง has_media=1\r\n * รองรับพารามิเตอร์กรองเพิ่ม เช่น resource_class_label, \"o:resource_class\", item_set_id, property[]\r\n */\r\nexport async function fetchItemsLite({\r\n  limit = 12,\r\n  page = 1,\r\n  sortBy = \"created\",\r\n  sortOrder = \"desc\",\r\n  query,\r\n  ...restFilters\r\n} = {}) {\r\n  let base =\r\n    `/items?per_page=${encodeURIComponent(limit)}` +\r\n    `&page=${encodeURIComponent(page)}` +\r\n    `&sort_by=${encodeURIComponent(sortBy)}` +\r\n    `&sort_order=${encodeURIComponent(sortOrder)}` +\r\n    `&has_media=1`;\r\n\r\n  if (query && query.trim()) {\r\n    const q = query.trim();\r\n    base += `&${buildQuery({\r\n      property: [\r\n        { property: \"dcterms:title\", type: \"contains\", text: q },\r\n        { property: \"dcterms:description\", type: \"contains\", text: q },\r\n      ],\r\n    })}`;\r\n  }\r\n\r\n  if (restFilters && Object.keys(restFilters).length > 0) {\r\n    base += `&${buildQuery(restFilters)}`;\r\n  }\r\n\r\n  const url = withKeys(api(base));\r\n  return await getJson(url, { cacheTtlMs: 30000 });\r\n}\r\n\r\n/** อ่าน media ของ item เฉพาะเมื่อจำเป็น (lazy) */\r\nexport async function fetchMediaForItem(itemId, { cacheTtlMs = 60000 } = {}) {\r\n  const url = withKeys(api(`/media?item_id=${encodeURIComponent(itemId)}`));\r\n  return await getJson(url, { cacheTtlMs });\r\n}\r\n\r\n/** หา URL PDF (ยังคงไว้สำหรับปุ่ม “เปิดอ่าน”) */\r\nexport async function pdfUrlOf(item) {\r\n  const medias = Array.isArray(item?.[\"o:media\"]) ? item[\"o:media\"] : [];\r\n  for (const m of medias) {\r\n    const type = m?.[\"o:media_type\"] || \"\";\r\n    const direct = m?.[\"o:original_url\"] || m?.[\"o:source\"];\r\n    if (type.includes(\"pdf\") && direct) return direct;\r\n  }\r\n  if (medias.length) {\r\n    for (const ref of medias) {\r\n      const refId = ref?.[\"@id\"];\r\n      if (!refId) continue;\r\n      const url = withKeys(refId);\r\n      try {\r\n        const m = await getJson(url, { cacheTtlMs: 60000 });\r\n        const type = m?.[\"o:media_type\"] || \"\";\r\n        if (type.includes(\"pdf\")) {\r\n          return m?.[\"o:original_url\"] || m?.[\"o:source\"] || null;\r\n        }\r\n      } catch {}\r\n    }\r\n  }\r\n  const id = item?.[\"o:id\"];\r\n  if (!id) return null;\r\n  const list = await fetchMediaForItem(id);\r\n  const pdf = (Array.isArray(list) ? list : []).find((m) =>\r\n    (m?.[\"o:media_type\"] || \"\").includes(\"application/pdf\")\r\n  );\r\n  return pdf?.[\"o:original_url\"] || pdf?.[\"o:source\"] || null;\r\n}\r\n\r\n/** เปิด PDF */\r\nexport async function openPDFOf(item) {\r\n  const url = await pdfUrlOf(item);\r\n  if (!url) throw new Error(\"ไม่พบไฟล์ PDF\");\r\n  window.open(url, \"_blank\", \"noopener,noreferrer\");\r\n}\r\n\r\n/** ========= ตัวช่วยดึงรูปปกจาก API (รองรับ thumbnail_display_urls) ========= */\r\nconst thumbCache = new Map();\r\n\r\n/**\r\n * คืน URL ปกของ item:\r\n * 1) item.thumbnail_display_urls (medium > large > square > original)\r\n * 2) media ที่ฝังมาและเป็น image + thumbnail_display_urls\r\n * 3) media เป็น @id → ดึงรายละเอียดก่อนแล้วเลือกเหมาะสุด\r\n */\r\nexport async function thumbUrlOf(item) {\r\n  const itemId = item?.[\"o:id\"];\r\n  if (!itemId) return null;\r\n  if (thumbCache.has(itemId)) return thumbCache.get(itemId);\r\n\r\n  // (1) item-level thumbnails\r\n  const itThumb = item?.thumbnail_display_urls;\r\n  if (itThumb) {\r\n    const best =\r\n      itThumb.medium || itThumb.large || itThumb.square || itThumb.original || null;\r\n    if (best) { thumbCache.set(itemId, best); return best; }\r\n  }\r\n\r\n  // (2) media ฝังมา\r\n  const medias = Array.isArray(item?.[\"o:media\"]) ? item[\"o:media\"] : [];\r\n  for (const m of medias) {\r\n    const mt = m?.[\"o:media_type\"] || \"\";\r\n    const t = m?.thumbnail_display_urls;\r\n    if (mt.startsWith(\"image/\") && t) {\r\n      const best = t.medium || t.large || t.square || m?.[\"o:original_url\"] || null;\r\n      if (best) { thumbCache.set(itemId, best); return best; }\r\n    }\r\n  }\r\n\r\n  // (3) media เป็นลิงก์ @id → ดึงรายละเอียด\r\n  for (const ref of medias) {\r\n    const refId = ref?.[\"@id\"];\r\n    if (!refId) continue;\r\n    try {\r\n      const m = await getJson(withKeys(refId), { cacheTtlMs: 60000 });\r\n      const mt = m?.[\"o:media_type\"] || \"\";\r\n      const t = m?.thumbnail_display_urls;\r\n      const best =\r\n        t?.medium ||\r\n        t?.large ||\r\n        t?.square ||\r\n        (mt.startsWith(\"image/\") ? m?.[\"o:original_url\"] : null) ||\r\n        null;\r\n      if (best) { thumbCache.set(itemId, best); return best; }\r\n    } catch {}\r\n  }\r\n\r\n  thumbCache.set(itemId, null);\r\n  return null;\r\n}\r\n\r\n/** ========= โปรเปอร์ตีทั่วไป ========= */\r\nexport const titleOf = (it) =>\r\n  it?.[\"o:title\"] || it?.[\"dcterms:title\"]?.[0]?.[\"@value\"] || `#${it?.[\"o:id\"] || \"\"}`;\r\n\r\nexport const descOf = (it) =>\r\n  it?.[\"dcterms:description\"]?.[0]?.[\"@value\"] || \"\";\r\n\r\n/** ========= export fetch แบบเดิมเพื่อความเข้ากันได้ ========= */\r\nexport const fetchJsonWithProxies = async (finalUrl) => getJson(finalUrl, { cacheTtlMs: 30000 });\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}