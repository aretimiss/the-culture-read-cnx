{"ast":null,"code":"// src/pages/HomePage.js\nimport React,{useEffect,useMemo,useState}from\"react\";import\"../HomePage.css\";import SiteHeader from\"../components/SiteHeader\";import Hero from\"../components/Hero\";import BookCard from\"../components/BookCard\";import Footer from\"../components/Footer\";import{api,fetchJsonWithProxies,titleOf,descOf,openPDFOf}from\"../lib/omekaClient\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function HomePage(){const[items,setItems]=useState([]);const[query,setQuery]=useState(\"\");const[loading,setLoading]=useState(true);const[err,setErr]=useState(\"\");useEffect(()=>{load();},[]);const load=async()=>{try{setLoading(true);if(!process.env.REACT_APP_API_KEY_IDENTITY||!process.env.REACT_APP_API_KEY_CREDENTIAL){throw new Error(\"API keys not found. Please check your .env file.\");}const data=await fetchJsonWithProxies(api(\"/items\"));setItems(Array.isArray(data)?data:[]);setErr(\"\");}catch(e){setErr((e===null||e===void 0?void 0:e.message)||\"โหลดข้อมูลไม่สำเร็จ\");}finally{setLoading(false);}};const filtered=useMemo(()=>{if(!query.trim())return items.slice(0,12);const q=query.toLowerCase();return items.filter(it=>{const t=titleOf(it).toLowerCase();const d=(descOf(it)||\"\").toLowerCase();return t.includes(q)||d.includes(q);}).slice(0,12);},[items,query]);const openPDF=async item=>{try{await openPDFOf(item);}catch(e){alert((e===null||e===void 0?void 0:e.message)||\"เปิดไฟล์ไม่สำเร็จ\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-background-light text-[#111518]\",children:[/*#__PURE__*/_jsx(SiteHeader,{}),/*#__PURE__*/_jsx(\"div\",{className:\"h-[88px]\"}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(Hero,{query:query,setQuery:setQuery,onSearch:()=>{/* อนาคตอาจลิงก์ไป /books พร้อม query */}}),/*#__PURE__*/_jsxs(\"section\",{className:\"px-4 sm:px-10 lg:px-40\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u0E2D\\u0E22\\u0E39\\u0E48\\u0E43\\u0E19\\u0E0A\\u0E48\\u0E27\\u0E07\\u0E1E\\u0E31\\u0E12\\u0E19\\u0E32\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"state\",children:\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E42\\u0E2B\\u0E25\\u0E14\\u2026\"}):err?/*#__PURE__*/_jsxs(\"div\",{className:\"state text-red-500\",children:[\"\\u0E40\\u0E01\\u0E34\\u0E14\\u0E02\\u0E49\\u0E2D\\u0E1C\\u0E34\\u0E14\\u0E1E\\u0E25\\u0E32\\u0E14: \",err]}):filtered.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"state\",children:\"\\u0E44\\u0E21\\u0E48\\u0E1E\\u0E1A\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\"}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] items-stretch gap-6 p-4\",children:filtered.map(item=>/*#__PURE__*/_jsx(BookCard,{item:item,onOpen:openPDF},item[\"o:id\"]))})]})]}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","SiteHeader","Hero","BookCard","Footer","api","fetchJsonWithProxies","titleOf","descOf","openPDFOf","jsx","_jsx","jsxs","_jsxs","HomePage","items","setItems","query","setQuery","loading","setLoading","err","setErr","load","process","env","REACT_APP_API_KEY_IDENTITY","REACT_APP_API_KEY_CREDENTIAL","Error","data","Array","isArray","e","message","filtered","trim","slice","q","toLowerCase","filter","it","t","d","includes","openPDF","item","alert","className","children","onSearch","length","map","onOpen"],"sources":["C:/Users/Asus/Desktop/the-culture-read-cnx/src/pages/HomePage.js"],"sourcesContent":["// src/pages/HomePage.js\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport \"../HomePage.css\";\r\n\r\nimport SiteHeader from \"../components/SiteHeader\";\r\nimport Hero from \"../components/Hero\";\r\nimport BookCard from \"../components/BookCard\";\r\nimport Footer from \"../components/Footer\";\r\n\r\nimport {\r\n  api,\r\n  fetchJsonWithProxies,\r\n  titleOf,\r\n  descOf,\r\n  openPDFOf,\r\n} from \"../lib/omekaClient\";\r\n\r\nexport default function HomePage() {\r\n  const [items, setItems] = useState([]);\r\n  const [query, setQuery] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const [err, setErr] = useState(\"\");\r\n\r\n  useEffect(() => { load(); }, []);\r\n\r\n  const load = async () => {\r\n    try {\r\n      setLoading(true);\r\n      if (!process.env.REACT_APP_API_KEY_IDENTITY || !process.env.REACT_APP_API_KEY_CREDENTIAL) {\r\n        throw new Error(\"API keys not found. Please check your .env file.\");\r\n      }\r\n      const data = await fetchJsonWithProxies(api(\"/items\"));\r\n      setItems(Array.isArray(data) ? data : []);\r\n      setErr(\"\");\r\n    } catch (e) {\r\n      setErr(e?.message || \"โหลดข้อมูลไม่สำเร็จ\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const filtered = useMemo(() => {\r\n    if (!query.trim()) return items.slice(0, 12);\r\n    const q = query.toLowerCase();\r\n    return items.filter((it) => {\r\n      const t = titleOf(it).toLowerCase();\r\n      const d = (descOf(it) || \"\").toLowerCase();\r\n      return t.includes(q) || d.includes(q);\r\n    }).slice(0, 12);\r\n  }, [items, query]);\r\n\r\n  const openPDF = async (item) => {\r\n    try { await openPDFOf(item); } \r\n    catch (e) { alert(e?.message || \"เปิดไฟล์ไม่สำเร็จ\"); }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background-light text-[#111518]\">\r\n      <SiteHeader />\r\n      {/* เว้นที่สำหรับ header fixed */}\r\n      <div className=\"h-[88px]\" />\r\n      <main className=\"flex-1\">\r\n        <Hero query={query} setQuery={setQuery} onSearch={() => { /* อนาคตอาจลิงก์ไป /books พร้อม query */ }} />\r\n\r\n        <section className=\"px-4 sm:px-10 lg:px-40\">\r\n          <h2 className=\"section-title\">อยู่ในช่วงพัฒนา</h2>\r\n\r\n          {loading ? (\r\n            <div className=\"state\">กำลังโหลด…</div>\r\n          ) : err ? (\r\n            <div className=\"state text-red-500\">เกิดข้อผิดพลาด: {err}</div>\r\n          ) : filtered.length === 0 ? (\r\n            <div className=\"state\">ไม่พบรายการ</div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] items-stretch gap-6 p-4\">\r\n              {filtered.map((item) => (\r\n                <BookCard key={item[\"o:id\"]} item={item} onOpen={openPDF} />\r\n              ))}\r\n            </div>\r\n          )}\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}