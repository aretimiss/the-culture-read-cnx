{"ast":null,"code":"// src/components/PdfOverlay.jsx\nimport React,{useEffect,useRef,useState}from\"react\";import{Document,Page,pdfjs}from\"react-pdf\";import\"react-pdf/dist/Page/AnnotationLayer.css\";import\"react-pdf/dist/Page/TextLayer.css\";// ✅ worker แบบ local (คู่กับ react-pdf v10 + pdfjs-dist v5)\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";pdfjs.GlobalWorkerOptions.workerSrc=new URL(\"pdfjs-dist/build/pdf.worker.min.mjs\",import.meta.url).toString();/** ====== ENV & URL helpers ====== */const RAW_BASE=process.env.REACT_APP_API_BASE_URL||\"\";const BASE_URL=RAW_BASE.replace(/\\/+$/,\"\");const withKeys=url=>{const key_identity=process.env.REACT_APP_API_KEY_IDENTITY;const key_credential=process.env.REACT_APP_API_KEY_CREDENTIAL;const sep=url.includes(\"?\")?\"&\":\"?\";return\"\".concat(url).concat(sep,\"key_identity=\").concat(key_identity,\"&key_credential=\").concat(key_credential);};const api=path=>withKeys(\"\".concat(BASE_URL).concat(path.startsWith(\"/\")?path:\"/\".concat(path)));async function fetchJsonWithProxies(finalUrl){try{const r1=await fetch(\"https://api.allorigins.win/get?url=\".concat(encodeURIComponent(finalUrl)));if(r1.ok)return JSON.parse((await r1.json()).contents);}catch(_unused){}try{const r2=await fetch(\"https://api.codetabs.com/v1/proxy?quest=\".concat(encodeURIComponent(finalUrl)));if(r2.ok)return await r2.json();}catch(_unused2){}const r3=await fetch(finalUrl);if(!r3.ok)throw new Error(\"fetch failed\");return await r3.json();}/** ====== ตัวแปลง URL → proxy raw (สำหรับไฟล์ไบนารี) ====== */const toAllOriginsRaw=url=>\"https://api.allorigins.win/raw?url=\".concat(encodeURIComponent(url));const toCodetabsRaw=url=>\"https://api.codetabs.com/v1/proxy?quest=\".concat(encodeURIComponent(url));/**\r\n * PdfOverlay\r\n * props:\r\n *  - id: media id (แนะนำ) หรือ item id\r\n *  - onClose: ฟังก์ชันปิด overlay\r\n */export default function PdfOverlay(_ref){let{id,onClose}=_ref;const[pdfUrl,setPdfUrl]=useState(\"\");const[currentUrl,setCurrentUrl]=useState(\"\");// ใช้เปลี่ยนไป proxy เมื่อ error\nconst[numPages,setNumPages]=useState(null);const[width,setWidth]=useState(window.innerWidth);const[loading,setLoading]=useState(true);const[viewerMode,setViewerMode]=useState(\"pdfjs\");// 'pdfjs' | 'iframe'\nconst[triedProxy,setTriedProxy]=useState(0);// 0=ตรง,1=allorigins,2=codetabs\nconst scrollBoxRef=useRef(null);// ล็อกสกรอลล์หน้าหลัก\nuseEffect(()=>{const prev=document.body.style.overflow;document.body.style.overflow=\"hidden\";return()=>{document.body.style.overflow=prev;};},[]);useEffect(()=>{const onKey=e=>e.key===\"Escape\"&&(onClose===null||onClose===void 0?void 0:onClose());window.addEventListener(\"keydown\",onKey);return()=>window.removeEventListener(\"keydown\",onKey);},[onClose]);useEffect(()=>{const onResize=()=>setWidth(window.innerWidth);window.addEventListener(\"resize\",onResize);return()=>window.removeEventListener(\"resize\",onResize);},[]);const getPdfUrlFromMediaId=async mediaId=>{const media=await fetchJsonWithProxies(api(\"/media/\".concat(mediaId)));const url=(media===null||media===void 0?void 0:media[\"o:original_url\"])||\"\";if(!url)throw new Error(\"media ไม่มี o:original_url\");return url;};const getPdfUrlFromItemId=async itemId=>{const item=await fetchJsonWithProxies(api(\"/items/\".concat(itemId)));const medias=(item===null||item===void 0?void 0:item[\"o:media\"])||[];for(const m of medias){const mid=m===null||m===void 0?void 0:m[\"o:id\"];if(!mid)continue;const media=await fetchJsonWithProxies(api(\"/media/\".concat(mid)));const url=(media===null||media===void 0?void 0:media[\"o:original_url\"])||\"\";if(url.toLowerCase().endsWith(\".pdf\"))return url;}throw new Error(\"ไม่พบไฟล์ PDF ใน item นี้\");};// โหลด URL หลักครั้งแรก\nuseEffect(()=>{(async()=>{try{setLoading(true);setViewerMode(\"pdfjs\");setTriedProxy(0);let url=\"\";try{url=await getPdfUrlFromMediaId(id);}catch(_unused3){url=await getPdfUrlFromItemId(id);}setPdfUrl(url);setCurrentUrl(url);// เริ่มจาก URL ตรง\n}catch(e){console.error(e);alert(\"ไม่สามารถโหลดไฟล์ PDF ได้\");onClose===null||onClose===void 0?void 0:onClose();}finally{setLoading(false);}})();},[id,onClose]);const handlePdfError=()=>{// ลอง proxy แบบ raw ทีละตัว แล้วค่อย fallback เป็น iframe\nif(triedProxy===0){setCurrentUrl(toAllOriginsRaw(pdfUrl));setTriedProxy(1);}else if(triedProxy===1){setCurrentUrl(toCodetabsRaw(pdfUrl));setTriedProxy(2);}else{// ใช้ iframe เป็นแผน C\nsetViewerMode(\"iframe\");}};const isWide=width>1024;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-[2000] bg-black/70 backdrop-blur-sm flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-[98vw] h-[94vh] max-w-[1400px] bg-[#fbf6ed] rounded-2xl shadow-2xl flex flex-col overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 sm:px-6 py-3 border-b border-[#eadfd2] bg-[#fffdf6]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-[#5b4a3e]\",children:\"\\u0E2D\\u0E48\\u0E32\\u0E19\\u0E40\\u0E2D\\u0E01\\u0E2A\\u0E32\\u0E23\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[pdfUrl&&/*#__PURE__*/_jsx(\"a\",{href:pdfUrl,target:\"_blank\",rel:\"noreferrer\",className:\"px-3 py-1.5 rounded-md border border-[#e8dccc] text-[#5b4a3e] hover:bg-[#fff7ef]\",children:\"\\u0E40\\u0E1B\\u0E34\\u0E14\\u0E43\\u0E19\\u0E41\\u0E17\\u0E47\\u0E1A\\u0E43\\u0E2B\\u0E21\\u0E48\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-1.5 rounded-md bg-[#d8653b] text-white hover:bg-[#c85a32]\",children:\"\\u0E1B\\u0E34\\u0E14\"})]})]}),/*#__PURE__*/_jsx(\"div\",{ref:scrollBoxRef,className:\"flex-1 overflow-auto px-2 sm:px-4 py-4\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-10 w-10 border-b-2 border-[#d8653b]\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 text-[#a36a46]\",children:\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E2B\\u0E19\\u0E31\\u0E07\\u0E2A\\u0E37\\u0E2D...\"})]}):viewerMode===\"iframe\"?/*#__PURE__*/// ✅ Fallback: iframe (ถ้าเซิร์ฟเวอร์ไม่บล็อก X-Frame-Options)\n_jsx(\"iframe\",{title:\"pdf\",src:currentUrl,className:\"w-full h-[80vh] rounded-lg bg-white\"}):/*#__PURE__*/// ✅ ปกติ: ใช้ pdf.js ผ่าน react-pdf\n_jsx(\"div\",{className:\"flex flex-col items-center\",children:/*#__PURE__*/_jsx(Document,{file:{url:currentUrl},onLoadSuccess:_ref2=>{let{numPages}=_ref2;return setNumPages(numPages);},onLoadError:handlePdfError// 🔥 ถ้า error → ลอง proxy / iframe\n,loading:\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E42\\u0E2B\\u0E25\\u0E14\\u0E40\\u0E2D\\u0E01\\u0E2A\\u0E32\\u0E23...\",className:\"bg-[#fffdf6]\",children:Array.from(new Array(numPages),(_,i)=>isWide?i%2===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center mb-4 gap-4\",children:[/*#__PURE__*/_jsx(Page,{pageNumber:i+1,width:Math.min(620,width/2.2),renderAnnotationLayer:false,renderTextLayer:true}),i+2<=numPages&&/*#__PURE__*/_jsx(Page,{pageNumber:i+2,width:Math.min(620,width/2.2),renderAnnotationLayer:false,renderTextLayer:true})]},i):/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-4\",children:/*#__PURE__*/_jsx(Page,{pageNumber:i+1,width:Math.min(820,width-32),renderAnnotationLayer:false,renderTextLayer:true})},i))})})})]})});}","map":{"version":3,"names":["React","useEffect","useRef","useState","Document","Page","pdfjs","jsx","_jsx","jsxs","_jsxs","GlobalWorkerOptions","workerSrc","URL","import","meta","url","toString","RAW_BASE","process","env","REACT_APP_API_BASE_URL","BASE_URL","replace","withKeys","key_identity","REACT_APP_API_KEY_IDENTITY","key_credential","REACT_APP_API_KEY_CREDENTIAL","sep","includes","concat","api","path","startsWith","fetchJsonWithProxies","finalUrl","r1","fetch","encodeURIComponent","ok","JSON","parse","json","contents","_unused","r2","_unused2","r3","Error","toAllOriginsRaw","toCodetabsRaw","PdfOverlay","_ref","id","onClose","pdfUrl","setPdfUrl","currentUrl","setCurrentUrl","numPages","setNumPages","width","setWidth","window","innerWidth","loading","setLoading","viewerMode","setViewerMode","triedProxy","setTriedProxy","scrollBoxRef","prev","document","body","style","overflow","onKey","e","key","addEventListener","removeEventListener","onResize","getPdfUrlFromMediaId","mediaId","media","getPdfUrlFromItemId","itemId","item","medias","m","mid","toLowerCase","endsWith","_unused3","console","error","alert","handlePdfError","isWide","className","children","href","target","rel","onClick","ref","title","src","file","onLoadSuccess","_ref2","onLoadError","Array","from","_","i","pageNumber","Math","min","renderAnnotationLayer","renderTextLayer"],"sources":["C:/Users/Asus/Desktop/the-culture-read-cnx/src/components/PdfOverlay.jsx"],"sourcesContent":["// src/components/PdfOverlay.jsx\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { Document, Page, pdfjs } from \"react-pdf\";\r\nimport \"react-pdf/dist/Page/AnnotationLayer.css\";\r\nimport \"react-pdf/dist/Page/TextLayer.css\";\r\n\r\n// ✅ worker แบบ local (คู่กับ react-pdf v10 + pdfjs-dist v5)\r\npdfjs.GlobalWorkerOptions.workerSrc = new URL(\r\n  \"pdfjs-dist/build/pdf.worker.min.mjs\",\r\n  import.meta.url\r\n).toString();\r\n\r\n/** ====== ENV & URL helpers ====== */\r\nconst RAW_BASE = process.env.REACT_APP_API_BASE_URL || \"\";\r\nconst BASE_URL = RAW_BASE.replace(/\\/+$/, \"\");\r\nconst withKeys = (url) => {\r\n  const key_identity = process.env.REACT_APP_API_KEY_IDENTITY;\r\n  const key_credential = process.env.REACT_APP_API_KEY_CREDENTIAL;\r\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\r\n  return `${url}${sep}key_identity=${key_identity}&key_credential=${key_credential}`;\r\n};\r\nconst api = (path) =>\r\n  withKeys(`${BASE_URL}${path.startsWith(\"/\") ? path : `/${path}`}`);\r\n\r\nasync function fetchJsonWithProxies(finalUrl) {\r\n  try {\r\n    const r1 = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(finalUrl)}`);\r\n    if (r1.ok) return JSON.parse((await r1.json()).contents);\r\n  } catch {}\r\n  try {\r\n    const r2 = await fetch(`https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(finalUrl)}`);\r\n    if (r2.ok) return await r2.json();\r\n  } catch {}\r\n  const r3 = await fetch(finalUrl);\r\n  if (!r3.ok) throw new Error(\"fetch failed\");\r\n  return await r3.json();\r\n}\r\n\r\n/** ====== ตัวแปลง URL → proxy raw (สำหรับไฟล์ไบนารี) ====== */\r\nconst toAllOriginsRaw = (url) =>\r\n  `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;\r\nconst toCodetabsRaw = (url) =>\r\n  `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`;\r\n\r\n/**\r\n * PdfOverlay\r\n * props:\r\n *  - id: media id (แนะนำ) หรือ item id\r\n *  - onClose: ฟังก์ชันปิด overlay\r\n */\r\nexport default function PdfOverlay({ id, onClose }) {\r\n  const [pdfUrl, setPdfUrl] = useState(\"\");\r\n  const [currentUrl, setCurrentUrl] = useState(\"\"); // ใช้เปลี่ยนไป proxy เมื่อ error\r\n  const [numPages, setNumPages] = useState(null);\r\n  const [width, setWidth] = useState(window.innerWidth);\r\n  const [loading, setLoading] = useState(true);\r\n  const [viewerMode, setViewerMode] = useState(\"pdfjs\"); // 'pdfjs' | 'iframe'\r\n  const [triedProxy, setTriedProxy] = useState(0); // 0=ตรง,1=allorigins,2=codetabs\r\n  const scrollBoxRef = useRef(null);\r\n\r\n  // ล็อกสกรอลล์หน้าหลัก\r\n  useEffect(() => {\r\n    const prev = document.body.style.overflow;\r\n    document.body.style.overflow = \"hidden\";\r\n    return () => { document.body.style.overflow = prev; };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const onKey = (e) => e.key === \"Escape\" && onClose?.();\r\n    window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [onClose]);\r\n\r\n  useEffect(() => {\r\n    const onResize = () => setWidth(window.innerWidth);\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  const getPdfUrlFromMediaId = async (mediaId) => {\r\n    const media = await fetchJsonWithProxies(api(`/media/${mediaId}`));\r\n    const url = media?.[\"o:original_url\"] || \"\";\r\n    if (!url) throw new Error(\"media ไม่มี o:original_url\");\r\n    return url;\r\n  };\r\n  const getPdfUrlFromItemId = async (itemId) => {\r\n    const item = await fetchJsonWithProxies(api(`/items/${itemId}`));\r\n    const medias = item?.[\"o:media\"] || [];\r\n    for (const m of medias) {\r\n      const mid = m?.[\"o:id\"];\r\n      if (!mid) continue;\r\n      const media = await fetchJsonWithProxies(api(`/media/${mid}`));\r\n      const url = media?.[\"o:original_url\"] || \"\";\r\n      if (url.toLowerCase().endsWith(\".pdf\")) return url;\r\n    }\r\n    throw new Error(\"ไม่พบไฟล์ PDF ใน item นี้\");\r\n  };\r\n\r\n  // โหลด URL หลักครั้งแรก\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        setLoading(true);\r\n        setViewerMode(\"pdfjs\");\r\n        setTriedProxy(0);\r\n\r\n        let url = \"\";\r\n        try {\r\n          url = await getPdfUrlFromMediaId(id);\r\n        } catch {\r\n          url = await getPdfUrlFromItemId(id);\r\n        }\r\n\r\n        setPdfUrl(url);\r\n        setCurrentUrl(url); // เริ่มจาก URL ตรง\r\n      } catch (e) {\r\n        console.error(e);\r\n        alert(\"ไม่สามารถโหลดไฟล์ PDF ได้\");\r\n        onClose?.();\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, [id, onClose]);\r\n\r\n  const handlePdfError = () => {\r\n    // ลอง proxy แบบ raw ทีละตัว แล้วค่อย fallback เป็น iframe\r\n    if (triedProxy === 0) {\r\n      setCurrentUrl(toAllOriginsRaw(pdfUrl));\r\n      setTriedProxy(1);\r\n    } else if (triedProxy === 1) {\r\n      setCurrentUrl(toCodetabsRaw(pdfUrl));\r\n      setTriedProxy(2);\r\n    } else {\r\n      // ใช้ iframe เป็นแผน C\r\n      setViewerMode(\"iframe\");\r\n    }\r\n  };\r\n\r\n  const isWide = width > 1024;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[2000] bg-black/70 backdrop-blur-sm flex items-center justify-center\">\r\n      <div className=\"w-[98vw] h-[94vh] max-w-[1400px] bg-[#fbf6ed] rounded-2xl shadow-2xl flex flex-col overflow-hidden\">\r\n        {/* Top bar */}\r\n        <div className=\"flex items-center justify-between px-4 sm:px-6 py-3 border-b border-[#eadfd2] bg-[#fffdf6]\">\r\n          <div className=\"font-semibold text-[#5b4a3e]\">อ่านเอกสาร</div>\r\n          <div className=\"flex items-center gap-2\">\r\n            {pdfUrl && (\r\n              <a\r\n                href={pdfUrl}\r\n                target=\"_blank\"\r\n                rel=\"noreferrer\"\r\n                className=\"px-3 py-1.5 rounded-md border border-[#e8dccc] text-[#5b4a3e] hover:bg-[#fff7ef]\"\r\n              >\r\n                เปิดในแท็บใหม่\r\n              </a>\r\n            )}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"px-4 py-1.5 rounded-md bg-[#d8653b] text-white hover:bg-[#c85a32]\"\r\n            >\r\n              ปิด\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Body */}\r\n        <div ref={scrollBoxRef} className=\"flex-1 overflow-auto px-2 sm:px-4 py-4\">\r\n          {loading ? (\r\n            <div className=\"h-full flex flex-col items-center justify-center\">\r\n              <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-[#d8653b]\" />\r\n              <p className=\"mt-3 text-[#a36a46]\">กำลังโหลดหนังสือ...</p>\r\n            </div>\r\n          ) : viewerMode === \"iframe\" ? (\r\n            // ✅ Fallback: iframe (ถ้าเซิร์ฟเวอร์ไม่บล็อก X-Frame-Options)\r\n            <iframe\r\n              title=\"pdf\"\r\n              src={currentUrl}\r\n              className=\"w-full h-[80vh] rounded-lg bg-white\"\r\n            />\r\n          ) : (\r\n            // ✅ ปกติ: ใช้ pdf.js ผ่าน react-pdf\r\n            <div className=\"flex flex-col items-center\">\r\n              <Document\r\n                file={{ url: currentUrl }}\r\n                onLoadSuccess={({ numPages }) => setNumPages(numPages)}\r\n                onLoadError={handlePdfError}          // 🔥 ถ้า error → ลอง proxy / iframe\r\n                loading=\"กำลังโหลดเอกสาร...\"\r\n                className=\"bg-[#fffdf6]\"\r\n              >\r\n                {Array.from(new Array(numPages), (_, i) =>\r\n                  isWide ? (\r\n                    i % 2 === 0 && (\r\n                      <div key={i} className=\"flex justify-center mb-4 gap-4\">\r\n                        <Page pageNumber={i + 1} width={Math.min(620, width / 2.2)} renderAnnotationLayer={false} renderTextLayer />\r\n                        {i + 2 <= numPages && (\r\n                          <Page pageNumber={i + 2} width={Math.min(620, width / 2.2)} renderAnnotationLayer={false} renderTextLayer />\r\n                        )}\r\n                      </div>\r\n                    )\r\n                  ) : (\r\n                    <div key={i} className=\"flex justify-center mb-4\">\r\n                      <Page pageNumber={i + 1} width={Math.min(820, width - 32)} renderAnnotationLayer={false} renderTextLayer />\r\n                    </div>\r\n                  )\r\n                )}\r\n              </Document>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}