{"ast":null,"code":"// src/lib/omekaClient.js\nimport axios from \"axios\";\n\n/** ========= ENV (รองรับ Vite/CRA) ========= */\nconst isVite = typeof import.meta !== \"undefined\" && import.meta.env;\nconst RAW_BASE = (isVite ? import.meta.env.VITE_API_BASE_URL : process.env.REACT_APP_API_BASE_URL) || \"\";\nconst KEY_ID = (isVite ? import.meta.env.VITE_API_KEY_IDENTITY : process.env.REACT_APP_API_KEY_IDENTITY) || \"\";\nconst KEY_CRED = (isVite ? import.meta.env.VITE_API_KEY_CREDENTIAL : process.env.REACT_APP_API_KEY_CREDENTIAL) || \"\";\nconst BASE_URL = RAW_BASE.trim().replace(/\\/+$/, \"\");\n\n/** ========= Assert ========= */\nfunction assertEnv() {\n  if (!BASE_URL) throw new Error(\"Missing API base URL (.env)\");\n  if (!KEY_ID || !KEY_CRED) throw new Error(\"Missing API keys (.env)\");\n}\n\n/** ========= URL helpers ========= */\nexport const api = path => {\n  assertEnv();\n  const clean = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${BASE_URL}${clean}`;\n};\nexport const withKeys = url => {\n  assertEnv();\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\n  return `${url}${sep}key_identity=${encodeURIComponent(KEY_ID)}&key_credential=${encodeURIComponent(KEY_CRED)}`;\n};\n\n/** ========= Axios instance + lightweight cache ========= */\nconst http = axios.create({\n  timeout: 8000,\n  headers: {\n    Accept: \"application/json\"\n  }\n});\n\n// in-memory cache (URL -> { t, data })\nconst cache = new Map();\nconst now = () => Date.now();\n\n/** GET with cache + graceful CORS fallbacks */\nasync function getJson(url, {\n  cacheTtlMs = 30000\n} = {}) {\n  const hit = cache.get(url);\n  if (hit && now() - hit.t < cacheTtlMs) return hit.data;\n  try {\n    const r = await http.get(url);\n    cache.set(url, {\n      t: now(),\n      data: r.data\n    });\n    return r.data;\n  } catch (e1) {\n    try {\n      var _r2$data;\n      const via = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\n      const r2 = await http.get(via);\n      const data = typeof ((_r2$data = r2.data) === null || _r2$data === void 0 ? void 0 : _r2$data.contents) === \"string\" ? JSON.parse(r2.data.contents) : r2.data;\n      cache.set(url, {\n        t: now(),\n        data\n      });\n      return data;\n    } catch (e2) {\n      const via2 = `https://api.codetabs.com/v1/proxy/?quest=${encodeURIComponent(url)}`;\n      const r3 = await http.get(via2);\n      cache.set(url, {\n        t: now(),\n        data: r3.data\n      });\n      return r3.data;\n    }\n  }\n}\n\n/** ========= Public fetchers (เบา) ========= */\n/**\r\n * ดึง items แบบเบา: จำกัดจำนวน/เรียงลำดับ + กรอง has_media=1\r\n * ไม่ embed หนัก เพียงพอสำหรับ Home/Listing\r\n */\nexport async function fetchItemsLite({\n  limit = 12,\n  page = 1,\n  sortBy = \"created\",\n  sortOrder = \"desc\",\n  query\n} = {}) {\n  let path = `/items?per_page=${encodeURIComponent(limit)}` + `&page=${encodeURIComponent(page)}` + `&sort_by=${encodeURIComponent(sortBy)}` + `&sort_order=${encodeURIComponent(sortOrder)}` + `&has_media=1`; // เพิ่มเพื่อโอกาสมีปกสูง\n\n  if (query && query.trim()) {\n    const q = encodeURIComponent(query.trim());\n    path += `&property[0][property]=dcterms:title&property[0][type]=contains&property[0][text]=${q}` + `&property[1][property]=dcterms:description&property[1][type]=contains&property[1][text]=${q}`;\n  }\n  const url = withKeys(api(path));\n  return await getJson(url, {\n    cacheTtlMs: 30000\n  });\n}\n\n/** อ่าน media ของ item เฉพาะเมื่อจำเป็น (lazy) */\nexport async function fetchMediaForItem(itemId, {\n  cacheTtlMs = 60000\n} = {}) {\n  const url = withKeys(api(`/media?item_id=${encodeURIComponent(itemId)}`));\n  return await getJson(url, {\n    cacheTtlMs\n  });\n}\n\n/** หา URL PDF (ยังคงไว้สำหรับปุ่ม “เปิดอ่าน”) */\nexport async function pdfUrlOf(item) {\n  const medias = Array.isArray(item === null || item === void 0 ? void 0 : item[\"o:media\"]) ? item[\"o:media\"] : [];\n  for (const m of medias) {\n    const type = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n    const direct = (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || (m === null || m === void 0 ? void 0 : m[\"o:source\"]);\n    if (type.includes(\"pdf\") && direct) return direct;\n  }\n  if (medias.length) {\n    for (const ref of medias) {\n      const refId = ref === null || ref === void 0 ? void 0 : ref[\"@id\"];\n      if (!refId) continue;\n      const url = withKeys(refId);\n      try {\n        const m = await getJson(url, {\n          cacheTtlMs: 60000\n        });\n        const type = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n        if (type.includes(\"pdf\")) {\n          return (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || (m === null || m === void 0 ? void 0 : m[\"o:source\"]) || null;\n        }\n      } catch {}\n    }\n  }\n  const id = item === null || item === void 0 ? void 0 : item[\"o:id\"];\n  if (!id) return null;\n  const list = await fetchMediaForItem(id);\n  const pdf = (Array.isArray(list) ? list : []).find(m => ((m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\").includes(\"application/pdf\"));\n  return (pdf === null || pdf === void 0 ? void 0 : pdf[\"o:original_url\"]) || (pdf === null || pdf === void 0 ? void 0 : pdf[\"o:source\"]) || null;\n}\n\n/** เปิด PDF */\nexport async function openPDFOf(item) {\n  const url = await pdfUrlOf(item);\n  if (!url) throw new Error(\"ไม่พบไฟล์ PDF\");\n  window.open(url, \"_blank\", \"noopener,noreferrer\");\n}\n\n/** ========= ตัวช่วยดึงรูปปกจาก API (รองรับ thumbnail_display_urls) ========= */\nconst thumbCache = new Map();\n\n/**\r\n * คืน URL ปกของ item:\r\n * 1) item.thumbnail_display_urls (medium > large > square > original)\r\n * 2) media ที่ฝังมาและเป็น image + thumbnail_display_urls\r\n * 3) media เป็น @id → ดึงมาแบบเบา แล้วคัดตามข้อ 2\r\n */\nexport async function thumbUrlOf(item) {\n  const itemId = item === null || item === void 0 ? void 0 : item[\"o:id\"];\n  if (!itemId) return null;\n  if (thumbCache.has(itemId)) return thumbCache.get(itemId);\n\n  // (1) item-level thumbnails (ตรงกับ JSON ของคุณ)\n  const itThumb = item === null || item === void 0 ? void 0 : item.thumbnail_display_urls;\n  if (itThumb) {\n    const best = itThumb.medium || itThumb.large || itThumb.square || itThumb.original || null;\n    if (best) {\n      thumbCache.set(itemId, best);\n      return best;\n    }\n  }\n\n  // (2) media ฝังมา\n  const medias = Array.isArray(item === null || item === void 0 ? void 0 : item[\"o:media\"]) ? item[\"o:media\"] : [];\n  for (const m of medias) {\n    const mt = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n    const t = m === null || m === void 0 ? void 0 : m.thumbnail_display_urls;\n    if (mt.startsWith(\"image/\") && t) {\n      const best = t.medium || t.large || t.square || (m === null || m === void 0 ? void 0 : m[\"o:original_url\"]) || null;\n      if (best) {\n        thumbCache.set(itemId, best);\n        return best;\n      }\n    }\n  }\n\n  // (3) media เป็นลิงก์ @id → ดึงรายละเอียด\n  for (const ref of medias) {\n    const refId = ref === null || ref === void 0 ? void 0 : ref[\"@id\"];\n    if (!refId) continue;\n    try {\n      const m = await getJson(withKeys(refId), {\n        cacheTtlMs: 60000\n      });\n      const mt = (m === null || m === void 0 ? void 0 : m[\"o:media_type\"]) || \"\";\n      const t = m === null || m === void 0 ? void 0 : m.thumbnail_display_urls;\n      const best = (t === null || t === void 0 ? void 0 : t.medium) || (t === null || t === void 0 ? void 0 : t.large) || (t === null || t === void 0 ? void 0 : t.square) || (mt.startsWith(\"image/\") ? m === null || m === void 0 ? void 0 : m[\"o:original_url\"] : null) || null;\n      if (best) {\n        thumbCache.set(itemId, best);\n        return best;\n      }\n    } catch {}\n  }\n  thumbCache.set(itemId, null);\n  return null;\n}\n\n/** ========= โปรเปอร์ตีทั่วไป ========= */\nexport const titleOf = it => {\n  var _it$dctermsTitle, _it$dctermsTitle$;\n  return (it === null || it === void 0 ? void 0 : it[\"o:title\"]) || (it === null || it === void 0 ? void 0 : (_it$dctermsTitle = it[\"dcterms:title\"]) === null || _it$dctermsTitle === void 0 ? void 0 : (_it$dctermsTitle$ = _it$dctermsTitle[0]) === null || _it$dctermsTitle$ === void 0 ? void 0 : _it$dctermsTitle$[\"@value\"]) || `#${(it === null || it === void 0 ? void 0 : it[\"o:id\"]) || \"\"}`;\n};\nexport const descOf = it => {\n  var _it$dctermsDescripti, _it$dctermsDescripti$;\n  return (it === null || it === void 0 ? void 0 : (_it$dctermsDescripti = it[\"dcterms:description\"]) === null || _it$dctermsDescripti === void 0 ? void 0 : (_it$dctermsDescripti$ = _it$dctermsDescripti[0]) === null || _it$dctermsDescripti$ === void 0 ? void 0 : _it$dctermsDescripti$[\"@value\"]) || \"\";\n};\n\n/** ========= export fetch แบบเดิมเพื่อความเข้ากันได้ ========= */\nexport const fetchJsonWithProxies = async finalUrl => getJson(finalUrl, {\n  cacheTtlMs: 30000\n});","map":{"version":3,"names":["axios","isVite","import","meta","env","RAW_BASE","VITE_API_BASE_URL","process","REACT_APP_API_BASE_URL","KEY_ID","VITE_API_KEY_IDENTITY","REACT_APP_API_KEY_IDENTITY","KEY_CRED","VITE_API_KEY_CREDENTIAL","REACT_APP_API_KEY_CREDENTIAL","BASE_URL","trim","replace","assertEnv","Error","api","path","clean","startsWith","withKeys","url","sep","includes","encodeURIComponent","http","create","timeout","headers","Accept","cache","Map","now","Date","getJson","cacheTtlMs","hit","get","t","data","r","set","e1","_r2$data","via","r2","contents","JSON","parse","e2","via2","r3","fetchItemsLite","limit","page","sortBy","sortOrder","query","q","fetchMediaForItem","itemId","pdfUrlOf","item","medias","Array","isArray","m","type","direct","length","ref","refId","id","list","pdf","find","openPDFOf","window","open","thumbCache","thumbUrlOf","has","itThumb","thumbnail_display_urls","best","medium","large","square","original","mt","titleOf","it","_it$dctermsTitle","_it$dctermsTitle$","descOf","_it$dctermsDescripti","_it$dctermsDescripti$","fetchJsonWithProxies","finalUrl"],"sources":["C:/Users/user/Documents/GitHub/the-culture-read-cnx/src/lib/omekaClient.js"],"sourcesContent":["// src/lib/omekaClient.js\r\nimport axios from \"axios\";\r\n\r\n/** ========= ENV (รองรับ Vite/CRA) ========= */\r\nconst isVite = typeof import.meta !== \"undefined\" && import.meta.env;\r\nconst RAW_BASE =\r\n  (isVite ? import.meta.env.VITE_API_BASE_URL : process.env.REACT_APP_API_BASE_URL) || \"\";\r\nconst KEY_ID =\r\n  (isVite ? import.meta.env.VITE_API_KEY_IDENTITY : process.env.REACT_APP_API_KEY_IDENTITY) || \"\";\r\nconst KEY_CRED =\r\n  (isVite ? import.meta.env.VITE_API_KEY_CREDENTIAL : process.env.REACT_APP_API_KEY_CREDENTIAL) || \"\";\r\nconst BASE_URL = RAW_BASE.trim().replace(/\\/+$/, \"\");\r\n\r\n/** ========= Assert ========= */\r\nfunction assertEnv() {\r\n  if (!BASE_URL) throw new Error(\"Missing API base URL (.env)\");\r\n  if (!KEY_ID || !KEY_CRED) throw new Error(\"Missing API keys (.env)\");\r\n}\r\n\r\n/** ========= URL helpers ========= */\r\nexport const api = (path) => {\r\n  assertEnv();\r\n  const clean = path.startsWith(\"/\") ? path : `/${path}`;\r\n  return `${BASE_URL}${clean}`;\r\n};\r\n\r\nexport const withKeys = (url) => {\r\n  assertEnv();\r\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\r\n  return `${url}${sep}key_identity=${encodeURIComponent(KEY_ID)}&key_credential=${encodeURIComponent(\r\n    KEY_CRED\r\n  )}`;\r\n};\r\n\r\n/** ========= Axios instance + lightweight cache ========= */\r\nconst http = axios.create({\r\n  timeout: 8000,\r\n  headers: { Accept: \"application/json\" },\r\n});\r\n\r\n// in-memory cache (URL -> { t, data })\r\nconst cache = new Map();\r\nconst now = () => Date.now();\r\n\r\n/** GET with cache + graceful CORS fallbacks */\r\nasync function getJson(url, { cacheTtlMs = 30000 } = {}) {\r\n  const hit = cache.get(url);\r\n  if (hit && now() - hit.t < cacheTtlMs) return hit.data;\r\n\r\n  try {\r\n    const r = await http.get(url);\r\n    cache.set(url, { t: now(), data: r.data });\r\n    return r.data;\r\n  } catch (e1) {\r\n    try {\r\n      const via = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\r\n      const r2 = await http.get(via);\r\n      const data =\r\n        typeof r2.data?.contents === \"string\" ? JSON.parse(r2.data.contents) : r2.data;\r\n      cache.set(url, { t: now(), data });\r\n      return data;\r\n    } catch (e2) {\r\n      const via2 = `https://api.codetabs.com/v1/proxy/?quest=${encodeURIComponent(url)}`;\r\n      const r3 = await http.get(via2);\r\n      cache.set(url, { t: now(), data: r3.data });\r\n      return r3.data;\r\n    }\r\n  }\r\n}\r\n\r\n/** ========= Public fetchers (เบา) ========= */\r\n/**\r\n * ดึง items แบบเบา: จำกัดจำนวน/เรียงลำดับ + กรอง has_media=1\r\n * ไม่ embed หนัก เพียงพอสำหรับ Home/Listing\r\n */\r\nexport async function fetchItemsLite({\r\n  limit = 12,\r\n  page = 1,\r\n  sortBy = \"created\",\r\n  sortOrder = \"desc\",\r\n  query,\r\n} = {}) {\r\n  let path =\r\n    `/items?per_page=${encodeURIComponent(limit)}` +\r\n    `&page=${encodeURIComponent(page)}` +\r\n    `&sort_by=${encodeURIComponent(sortBy)}` +\r\n    `&sort_order=${encodeURIComponent(sortOrder)}` +\r\n    `&has_media=1`; // เพิ่มเพื่อโอกาสมีปกสูง\r\n\r\n  if (query && query.trim()) {\r\n    const q = encodeURIComponent(query.trim());\r\n    path +=\r\n      `&property[0][property]=dcterms:title&property[0][type]=contains&property[0][text]=${q}` +\r\n      `&property[1][property]=dcterms:description&property[1][type]=contains&property[1][text]=${q}`;\r\n  }\r\n\r\n  const url = withKeys(api(path));\r\n  return await getJson(url, { cacheTtlMs: 30000 });\r\n}\r\n\r\n/** อ่าน media ของ item เฉพาะเมื่อจำเป็น (lazy) */\r\nexport async function fetchMediaForItem(itemId, { cacheTtlMs = 60000 } = {}) {\r\n  const url = withKeys(api(`/media?item_id=${encodeURIComponent(itemId)}`));\r\n  return await getJson(url, { cacheTtlMs });\r\n}\r\n\r\n/** หา URL PDF (ยังคงไว้สำหรับปุ่ม “เปิดอ่าน”) */\r\nexport async function pdfUrlOf(item) {\r\n  const medias = Array.isArray(item?.[\"o:media\"]) ? item[\"o:media\"] : [];\r\n  for (const m of medias) {\r\n    const type = m?.[\"o:media_type\"] || \"\";\r\n    const direct = m?.[\"o:original_url\"] || m?.[\"o:source\"];\r\n    if (type.includes(\"pdf\") && direct) return direct;\r\n  }\r\n  if (medias.length) {\r\n    for (const ref of medias) {\r\n      const refId = ref?.[\"@id\"];\r\n      if (!refId) continue;\r\n      const url = withKeys(refId);\r\n      try {\r\n        const m = await getJson(url, { cacheTtlMs: 60000 });\r\n        const type = m?.[\"o:media_type\"] || \"\";\r\n        if (type.includes(\"pdf\")) {\r\n          return m?.[\"o:original_url\"] || m?.[\"o:source\"] || null;\r\n        }\r\n      } catch {}\r\n    }\r\n  }\r\n  const id = item?.[\"o:id\"];\r\n  if (!id) return null;\r\n  const list = await fetchMediaForItem(id);\r\n  const pdf = (Array.isArray(list) ? list : []).find((m) =>\r\n    (m?.[\"o:media_type\"] || \"\").includes(\"application/pdf\")\r\n  );\r\n  return pdf?.[\"o:original_url\"] || pdf?.[\"o:source\"] || null;\r\n}\r\n\r\n/** เปิด PDF */\r\nexport async function openPDFOf(item) {\r\n  const url = await pdfUrlOf(item);\r\n  if (!url) throw new Error(\"ไม่พบไฟล์ PDF\");\r\n  window.open(url, \"_blank\", \"noopener,noreferrer\");\r\n}\r\n\r\n/** ========= ตัวช่วยดึงรูปปกจาก API (รองรับ thumbnail_display_urls) ========= */\r\nconst thumbCache = new Map();\r\n\r\n/**\r\n * คืน URL ปกของ item:\r\n * 1) item.thumbnail_display_urls (medium > large > square > original)\r\n * 2) media ที่ฝังมาและเป็น image + thumbnail_display_urls\r\n * 3) media เป็น @id → ดึงมาแบบเบา แล้วคัดตามข้อ 2\r\n */\r\nexport async function thumbUrlOf(item) {\r\n  const itemId = item?.[\"o:id\"];\r\n  if (!itemId) return null;\r\n  if (thumbCache.has(itemId)) return thumbCache.get(itemId);\r\n\r\n  // (1) item-level thumbnails (ตรงกับ JSON ของคุณ)\r\n  const itThumb = item?.thumbnail_display_urls;\r\n  if (itThumb) {\r\n    const best = itThumb.medium || itThumb.large || itThumb.square || itThumb.original || null;\r\n    if (best) { thumbCache.set(itemId, best); return best; }\r\n  }\r\n\r\n  // (2) media ฝังมา\r\n  const medias = Array.isArray(item?.[\"o:media\"]) ? item[\"o:media\"] : [];\r\n  for (const m of medias) {\r\n    const mt = m?.[\"o:media_type\"] || \"\";\r\n    const t = m?.thumbnail_display_urls;\r\n    if (mt.startsWith(\"image/\") && t) {\r\n      const best = t.medium || t.large || t.square || m?.[\"o:original_url\"] || null;\r\n      if (best) { thumbCache.set(itemId, best); return best; }\r\n    }\r\n  }\r\n\r\n  // (3) media เป็นลิงก์ @id → ดึงรายละเอียด\r\n  for (const ref of medias) {\r\n    const refId = ref?.[\"@id\"];\r\n    if (!refId) continue;\r\n    try {\r\n      const m = await getJson(withKeys(refId), { cacheTtlMs: 60000 });\r\n      const mt = m?.[\"o:media_type\"] || \"\";\r\n      const t = m?.thumbnail_display_urls;\r\n      const best = t?.medium || t?.large || t?.square || (mt.startsWith(\"image/\") ? m?.[\"o:original_url\"] : null) || null;\r\n      if (best) { thumbCache.set(itemId, best); return best; }\r\n    } catch {}\r\n  }\r\n\r\n  thumbCache.set(itemId, null);\r\n  return null;\r\n}\r\n\r\n/** ========= โปรเปอร์ตีทั่วไป ========= */\r\nexport const titleOf = (it) =>\r\n  it?.[\"o:title\"] || it?.[\"dcterms:title\"]?.[0]?.[\"@value\"] || `#${it?.[\"o:id\"] || \"\"}`;\r\n\r\nexport const descOf = (it) =>\r\n  it?.[\"dcterms:description\"]?.[0]?.[\"@value\"] || \"\";\r\n\r\n/** ========= export fetch แบบเดิมเพื่อความเข้ากันได้ ========= */\r\nexport const fetchJsonWithProxies = async (finalUrl) => getJson(finalUrl, { cacheTtlMs: 30000 });\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}