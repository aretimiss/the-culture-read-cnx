{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Documents\\\\GitHub\\\\the-culture-read-cnx\\\\src\\\\pages\\\\BooksPage.js\",\n  _s = $RefreshSig$();\n// src/pages/BooksPage.jsx\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport SiteHeader from \"../components/SiteHeader\";\nimport Footer from \"../components/Footer\";\nimport BackToTop from \"../components/BackToTop\";\nimport BookCard from \"../components/BookCard\";\nimport { fetchItemsLite, fetchJsonWithProxies, withKeys, api } from \"../lib/omekaClient\";\nimport { pickLang } from \"../lib/i18nPick\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ShelfBar = () => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"h-3 rounded-full bg-gradient-to-b from-[#e7d8c9] to-[#d9c1a9] shadow-inner\"\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 21,\n  columnNumber: 3\n}, this);\n_c = ShelfBar;\nconst ShelfTitle = ({\n  children\n}) => /*#__PURE__*/_jsxDEV(\"h2\", {\n  className: \"text-xl md:text-2xl font-extrabold tracking-wide text-[#5b4a3e] mb-3\",\n  children: children\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 25,\n  columnNumber: 3\n}, this);\n\n/* ===== Skeleton Loader ===== */\n_c2 = ShelfTitle;\nconst SkeletonLibrary = () => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"py-20 flex flex-col items-center gap-6 animate-pulse text-[#5b4a3e]\",\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-8 w-52 bg-[#e5d7ca]/50 rounded-full\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-6 w-72 bg-[#e5d7ca]/40 rounded-full\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-6 w-64 bg-[#e5d7ca]/30 rounded-full\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-10 px-4 w-full max-w-6xl\",\n    children: Array.from({\n      length: 8\n    }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"aspect-[3/4] bg-[#e5d7ca]/40 rounded-xl shadow-sm\"\n    }, i, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 32,\n  columnNumber: 3\n}, this);\n_c3 = SkeletonLibrary;\nexport default function BooksPage() {\n  _s();\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const [items, setItems] = useState([]);\n  const [err, setErr] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const [query, setQuery] = useState(\"\");\n  const [activeSet, setActiveSet] = useState(\"all\");\n  const [setLabels, setSetLabels] = useState({});\n  const navigate = useNavigate();\n\n  /* 1) โหลดรายการหนังสือ (เมื่อภาษาเปลี่ยน) */\n  useEffect(() => {\n    (async () => {\n      try {\n        setLoading(true);\n        const data = await fetchItemsLite({\n          limit: 60,\n          sortBy: \"created\",\n          sortOrder: \"desc\"\n        });\n        setItems(Array.isArray(data) ? data : []);\n        setErr(\"\");\n      } catch (e) {\n        setErr((e === null || e === void 0 ? void 0 : e.message) || t(\"errors.loadFailed\", \"โหลดข้อมูลไม่สำเร็จ\"));\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [i18n.language]); // ✅ โหลดใหม่เมื่อเปลี่ยนภาษา\n\n  /* 2) สร้างป้ายชื่อคอลเลกชัน (รีเฟรชเมื่อภาษาเปลี่ยน) */\n  useEffect(() => {\n    (async () => {\n      try {\n        const ids = Array.from(new Set((Array.isArray(items) ? items : []).flatMap(it => (Array.isArray(it === null || it === void 0 ? void 0 : it[\"o:item_set\"]) ? it[\"o:item_set\"] : []).map(s => s === null || s === void 0 ? void 0 : s[\"o:id\"]).filter(Boolean))));\n        if (!ids.length) {\n          setSetLabels({});\n          return;\n        }\n        const pairs = await Promise.all(ids.map(async id => {\n          try {\n            const r = await fetchJsonWithProxies(withKeys(api(`/item_sets/${id}`)));\n            const name = pickLang(r === null || r === void 0 ? void 0 : r[\"dcterms:title\"], i18n.language) || (r === null || r === void 0 ? void 0 : r[\"o:title\"]) || `Collection #${id}`;\n            return [String(id), name];\n          } catch {\n            return [String(id), `Collection #${id}`];\n          }\n        }));\n        setSetLabels(Object.fromEntries(pairs));\n      } catch {\n        // ignore\n      }\n    })();\n  }, [items, i18n.language]);\n\n  /* Tabs หมวดหมู่ */\n  const categoryTabs = useMemo(() => {\n    const tabs = [{\n      id: \"all\",\n      label: t(\"filters.all\", \"ทั้งหมด\")\n    }];\n    const others = Object.entries(setLabels).map(([id, label]) => ({\n      id,\n      label\n    }));\n    return tabs.concat(others);\n  }, [setLabels, t]);\n\n  /* Filter รายการ */\n  const filtered = useMemo(() => {\n    const q = query.trim().toLowerCase();\n    return items.filter(it => {\n      const title = (pickLang(it === null || it === void 0 ? void 0 : it[\"dcterms:title\"], i18n.language) || \"\").toLowerCase();\n      const desc = (pickLang(it === null || it === void 0 ? void 0 : it[\"dcterms:description\"], i18n.language) || \"\").toLowerCase();\n      const hit = !q || title.includes(q) || desc.includes(q);\n      if (!hit) return false;\n      if (activeSet === \"all\") return true;\n      const sets = Array.isArray(it === null || it === void 0 ? void 0 : it[\"o:item_set\"]) ? it[\"o:item_set\"] : [];\n      return sets.some(s => String(s === null || s === void 0 ? void 0 : s[\"o:id\"]) === String(activeSet));\n    });\n  }, [items, query, activeSet, i18n.language]);\n  const groupedBySet = useMemo(() => {\n    if (activeSet !== \"all\") return {};\n    const groups = {};\n    filtered.forEach(it => {\n      const sets = Array.isArray(it === null || it === void 0 ? void 0 : it[\"o:item_set\"]) ? it[\"o:item_set\"] : [];\n      if (sets.length === 0) (groups[\"_none\"] ||= []).push(it);else {\n        sets.forEach(s => {\n          const key = String((s === null || s === void 0 ? void 0 : s[\"o:id\"]) || \"_none\");\n          (groups[key] ||= []).push(it);\n        });\n      }\n    });\n    return groups;\n  }, [filtered, activeSet]);\n  const singleShelfItems = useMemo(() => {\n    if (activeSet === \"all\") return [];\n    return filtered;\n  }, [filtered, activeSet]);\n  const openBook = item => {\n    const id = item === null || item === void 0 ? void 0 : item[\"o:id\"];\n    if (!id) return alert(t(\"errors.noId\", \"ไม่พบรหัสรายการ\"));\n    navigate(`/read/${id}`);\n  };\n\n  /* ==== UI ==== */\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-[#faf7f2] text-[#111518]\",\n    children: [/*#__PURE__*/_jsxDEV(SiteHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      mode: \"wait\",\n      children: loading ? /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0\n        },\n        animate: {\n          opacity: 1\n        },\n        exit: {\n          opacity: 0\n        },\n        transition: {\n          duration: 0.4\n        },\n        children: /*#__PURE__*/_jsxDEV(SkeletonLibrary, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }, this)\n      }, \"loading\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0\n        },\n        animate: {\n          opacity: 1\n        },\n        exit: {\n          opacity: 0\n        },\n        transition: {\n          duration: 0.4\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"relative h-[46vh] min-h-[360px] w-full overflow-hidden\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 bg-center bg-cover\",\n            style: {\n              backgroundImage: \"url(/assets/banner.webp)\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 bg-[#fff1e6]/60\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative z-10 h-full flex flex-col items-center justify-center text-center px-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-4xl md:text-6xl font-extrabold tracking-wide text-[#5b4a3e] drop-shadow\",\n              children: t(\"books.title\", \"ห้องสมุด\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mt-3 max-w-2xl text-[#5b4a3e]/80\",\n              children: t(\"books.subtitle\", \"ค้นหาและเลือกดูหนังสือจากคอลเลกชันต่าง ๆ\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 w-full max-w-xl\",\n              children: /*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: e => e.preventDefault(),\n                className: \"flex items-center rounded-2xl bg-white/90 ring-1 ring-black/10 shadow\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  value: query,\n                  onChange: e => setQuery(e.target.value),\n                  placeholder: t(\"search.placeholder\", \"ค้นหาชื่อหนังสือ / คำสำคัญ...\"),\n                  className: \"flex-1 px-4 py-3 rounded-2xl bg-transparent outline-none\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"px-5 py-3 font-semibold\",\n                  children: t(\"actions.search\", \"ค้นหา\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 223,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"max-w-7xl mx-auto px-4 sm:px-8 lg:px-12 mt-8 grid grid-cols-1 lg:grid-cols-4 gap-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n            className: \"lg:col-span-1\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sticky top-28 space-y-3 p-4 bg-white/70 backdrop-blur-md rounded-2xl shadow ring-1 ring-black/10\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"font-bold text-[#5b4a3e] mb-2\",\n                children: t(\"filters.category\", \"หมวดหมู่\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col gap-2\",\n                children: categoryTabs.map(tab => /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setActiveSet(tab.id),\n                  className: `text-left px-3 py-2 rounded-lg text-sm md:text-base font-medium transition ${activeSet === tab.id ? \"bg-[#5b4a3e] text-white shadow\" : \"hover:bg-black/5 text-[#5b4a3e]\"}`,\n                  children: tab.label\n                }, tab.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n            className: \"lg:col-span-3\",\n            children: err ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"py-16 text-center text-red-600\",\n              children: err\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 19\n            }, this) : filtered.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"py-16 text-center\",\n              children: t(\"status.noResults\", \"ไม่พบหนังสือที่ตรงกับเงื่อนไข\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 19\n            }, this) : activeSet === \"all\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-12\",\n              children: [Object.entries(groupedBySet).filter(([key]) => key !== \"_none\").map(([key, group]) => /*#__PURE__*/_jsxDEV(\"section\", {\n                children: [/*#__PURE__*/_jsxDEV(ShelfTitle, {\n                  children: setLabels[key] || `${t(\"books.collection\", \"คอลเลกชัน\")} #${key}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\",\n                  children: group.map(it => /*#__PURE__*/_jsxDEV(BookCard, {\n                    item: it,\n                    onOpen: openBook\n                  }, it[\"o:id\"], false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 277,\n                    columnNumber: 31\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 275,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(ShelfBar, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 27\n                }, this)]\n              }, key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 25\n              }, this)), groupedBySet[\"_none\"] && /*#__PURE__*/_jsxDEV(\"section\", {\n                children: [/*#__PURE__*/_jsxDEV(ShelfTitle, {\n                  children: t(\"books.uncategorized\", \"ไม่ระบุหมวด\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\",\n                  children: groupedBySet[\"_none\"].map(it => /*#__PURE__*/_jsxDEV(BookCard, {\n                    item: it,\n                    onOpen: openBook\n                  }, it[\"o:id\"], false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 29\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 292,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(ShelfBar, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"space-y-4\",\n              children: [/*#__PURE__*/_jsxDEV(ShelfTitle, {\n                children: setLabels[String(activeSet)] || t(\"books.collection\", \"คอลเลกชัน\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\",\n                children: singleShelfItems.map(it => /*#__PURE__*/_jsxDEV(BookCard, {\n                  item: it,\n                  onOpen: openBook\n                }, it[\"o:id\"], false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 313,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(ShelfBar, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(BackToTop, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 13\n        }, this)]\n      }, i18n.language, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 175,\n    columnNumber: 5\n  }, this);\n}\n_s(BooksPage, \"Yki56LOd3FSjfd+xBzI2VKhB4xA=\", false, function () {\n  return [useTranslation, useNavigate];\n});\n_c4 = BooksPage;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"ShelfBar\");\n$RefreshReg$(_c2, \"ShelfTitle\");\n$RefreshReg$(_c3, \"SkeletonLibrary\");\n$RefreshReg$(_c4, \"BooksPage\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useNavigate","useTranslation","motion","AnimatePresence","SiteHeader","Footer","BackToTop","BookCard","fetchItemsLite","fetchJsonWithProxies","withKeys","api","pickLang","jsxDEV","_jsxDEV","ShelfBar","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","ShelfTitle","children","_c2","SkeletonLibrary","Array","from","length","map","_","i","_c3","BooksPage","_s","t","i18n","items","setItems","err","setErr","loading","setLoading","query","setQuery","activeSet","setActiveSet","setLabels","setSetLabels","navigate","data","limit","sortBy","sortOrder","isArray","e","message","language","ids","Set","flatMap","it","s","filter","Boolean","pairs","Promise","all","id","r","name","String","Object","fromEntries","categoryTabs","tabs","label","others","entries","concat","filtered","q","trim","toLowerCase","title","desc","hit","includes","sets","some","groupedBySet","groups","forEach","push","key","singleShelfItems","openBook","item","alert","mode","div","initial","opacity","animate","exit","transition","duration","style","backgroundImage","onSubmit","preventDefault","value","onChange","target","placeholder","tab","onClick","group","onOpen","_c4","$RefreshReg$"],"sources":["C:/Users/user/Documents/GitHub/the-culture-read-cnx/src/pages/BooksPage.js"],"sourcesContent":["// src/pages/BooksPage.jsx\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nimport SiteHeader from \"../components/SiteHeader\";\nimport Footer from \"../components/Footer\";\nimport BackToTop from \"../components/BackToTop\";\nimport BookCard from \"../components/BookCard\";\n\nimport {\n  fetchItemsLite,\n  fetchJsonWithProxies,\n  withKeys,\n  api,\n} from \"../lib/omekaClient\";\nimport { pickLang } from \"../lib/i18nPick\";\n\nconst ShelfBar = () => (\n  <div className=\"h-3 rounded-full bg-gradient-to-b from-[#e7d8c9] to-[#d9c1a9] shadow-inner\" />\n);\n\nconst ShelfTitle = ({ children }) => (\n  <h2 className=\"text-xl md:text-2xl font-extrabold tracking-wide text-[#5b4a3e] mb-3\">\n    {children}\n  </h2>\n);\n\n/* ===== Skeleton Loader ===== */\nconst SkeletonLibrary = () => (\n  <div className=\"py-20 flex flex-col items-center gap-6 animate-pulse text-[#5b4a3e]\">\n    <div className=\"h-8 w-52 bg-[#e5d7ca]/50 rounded-full\" />\n    <div className=\"h-6 w-72 bg-[#e5d7ca]/40 rounded-full\" />\n    <div className=\"h-6 w-64 bg-[#e5d7ca]/30 rounded-full\" />\n    <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-10 px-4 w-full max-w-6xl\">\n      {Array.from({ length: 8 }).map((_, i) => (\n        <div\n          key={i}\n          className=\"aspect-[3/4] bg-[#e5d7ca]/40 rounded-xl shadow-sm\"\n        />\n      ))}\n    </div>\n  </div>\n);\n\nexport default function BooksPage() {\n  const { t, i18n } = useTranslation();\n\n  const [items, setItems] = useState([]);\n  const [err, setErr] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n\n  const [query, setQuery] = useState(\"\");\n  const [activeSet, setActiveSet] = useState(\"all\");\n  const [setLabels, setSetLabels] = useState({});\n\n  const navigate = useNavigate();\n\n  /* 1) โหลดรายการหนังสือ (เมื่อภาษาเปลี่ยน) */\n  useEffect(() => {\n    (async () => {\n      try {\n        setLoading(true);\n        const data = await fetchItemsLite({\n          limit: 60,\n          sortBy: \"created\",\n          sortOrder: \"desc\",\n        });\n        setItems(Array.isArray(data) ? data : []);\n        setErr(\"\");\n      } catch (e) {\n        setErr(e?.message || t(\"errors.loadFailed\", \"โหลดข้อมูลไม่สำเร็จ\"));\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [i18n.language]); // ✅ โหลดใหม่เมื่อเปลี่ยนภาษา\n\n  /* 2) สร้างป้ายชื่อคอลเลกชัน (รีเฟรชเมื่อภาษาเปลี่ยน) */\n  useEffect(() => {\n    (async () => {\n      try {\n        const ids = Array.from(\n          new Set(\n            (Array.isArray(items) ? items : []).flatMap((it) =>\n              (Array.isArray(it?.[\"o:item_set\"]) ? it[\"o:item_set\"] : [])\n                .map((s) => s?.[\"o:id\"])\n                .filter(Boolean)\n            )\n          )\n        );\n\n        if (!ids.length) {\n          setSetLabels({});\n          return;\n        }\n\n        const pairs = await Promise.all(\n          ids.map(async (id) => {\n            try {\n              const r = await fetchJsonWithProxies(withKeys(api(`/item_sets/${id}`)));\n              const name =\n                pickLang(r?.[\"dcterms:title\"], i18n.language) ||\n                r?.[\"o:title\"] ||\n                `Collection #${id}`;\n              return [String(id), name];\n            } catch {\n              return [String(id), `Collection #${id}`];\n            }\n          })\n        );\n        setSetLabels(Object.fromEntries(pairs));\n      } catch {\n        // ignore\n      }\n    })();\n  }, [items, i18n.language]);\n\n  /* Tabs หมวดหมู่ */\n  const categoryTabs = useMemo(() => {\n    const tabs = [{ id: \"all\", label: t(\"filters.all\", \"ทั้งหมด\") }];\n    const others = Object.entries(setLabels).map(([id, label]) => ({\n      id,\n      label,\n    }));\n    return tabs.concat(others);\n  }, [setLabels, t]);\n\n  /* Filter รายการ */\n  const filtered = useMemo(() => {\n    const q = query.trim().toLowerCase();\n    return items.filter((it) => {\n      const title = (pickLang(it?.[\"dcterms:title\"], i18n.language) || \"\").toLowerCase();\n      const desc = (pickLang(it?.[\"dcterms:description\"], i18n.language) || \"\").toLowerCase();\n\n      const hit = !q || title.includes(q) || desc.includes(q);\n      if (!hit) return false;\n\n      if (activeSet === \"all\") return true;\n      const sets = Array.isArray(it?.[\"o:item_set\"]) ? it[\"o:item_set\"] : [];\n      return sets.some((s) => String(s?.[\"o:id\"]) === String(activeSet));\n    });\n  }, [items, query, activeSet, i18n.language]);\n\n  const groupedBySet = useMemo(() => {\n    if (activeSet !== \"all\") return {};\n    const groups = {};\n    filtered.forEach((it) => {\n      const sets = Array.isArray(it?.[\"o:item_set\"]) ? it[\"o:item_set\"] : [];\n      if (sets.length === 0) (groups[\"_none\"] ||= []).push(it);\n      else {\n        sets.forEach((s) => {\n          const key = String(s?.[\"o:id\"] || \"_none\");\n          (groups[key] ||= []).push(it);\n        });\n      }\n    });\n    return groups;\n  }, [filtered, activeSet]);\n\n  const singleShelfItems = useMemo(() => {\n    if (activeSet === \"all\") return [];\n    return filtered;\n  }, [filtered, activeSet]);\n\n  const openBook = (item) => {\n    const id = item?.[\"o:id\"];\n    if (!id) return alert(t(\"errors.noId\", \"ไม่พบรหัสรายการ\"));\n    navigate(`/read/${id}`);\n  };\n\n  /* ==== UI ==== */\n  return (\n    <div className=\"min-h-screen bg-[#faf7f2] text-[#111518]\">\n      <SiteHeader />\n\n      <AnimatePresence mode=\"wait\">\n        {loading ? (\n          <motion.div\n            key=\"loading\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.4 }}\n          >\n            <SkeletonLibrary />\n          </motion.div>\n        ) : (\n          <motion.div\n            key={i18n.language}\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.4 }}\n          >\n            {/* HERO */}\n            <section className=\"relative h-[46vh] min-h-[360px] w-full overflow-hidden\">\n              <div\n                className=\"absolute inset-0 bg-center bg-cover\"\n                style={{ backgroundImage: \"url(/assets/banner.webp)\" }}\n              />\n              <div className=\"absolute inset-0 bg-[#fff1e6]/60\" />\n              <div className=\"relative z-10 h-full flex flex-col items-center justify-center text-center px-6\">\n                <h1 className=\"text-4xl md:text-6xl font-extrabold tracking-wide text-[#5b4a3e] drop-shadow\">\n                  {t(\"books.title\", \"ห้องสมุด\")}\n                </h1>\n                <p className=\"mt-3 max-w-2xl text-[#5b4a3e]/80\">\n                  {t(\"books.subtitle\", \"ค้นหาและเลือกดูหนังสือจากคอลเลกชันต่าง ๆ\")}\n                </p>\n\n                <div className=\"mt-6 w-full max-w-xl\">\n                  <form\n                    onSubmit={(e) => e.preventDefault()}\n                    className=\"flex items-center rounded-2xl bg-white/90 ring-1 ring-black/10 shadow\"\n                  >\n                    <input\n                      value={query}\n                      onChange={(e) => setQuery(e.target.value)}\n                      placeholder={t(\"search.placeholder\", \"ค้นหาชื่อหนังสือ / คำสำคัญ...\")}\n                      className=\"flex-1 px-4 py-3 rounded-2xl bg-transparent outline-none\"\n                    />\n                    <button className=\"px-5 py-3 font-semibold\">\n                      {t(\"actions.search\", \"ค้นหา\")}\n                    </button>\n                  </form>\n                </div>\n              </div>\n            </section>\n\n            {/* Layout: Sidebar + Shelf */}\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-8 lg:px-12 mt-8 grid grid-cols-1 lg:grid-cols-4 gap-8\">\n              {/* Sidebar */}\n              <aside className=\"lg:col-span-1\">\n                <div className=\"sticky top-28 space-y-3 p-4 bg-white/70 backdrop-blur-md rounded-2xl shadow ring-1 ring-black/10\">\n                  <h3 className=\"font-bold text-[#5b4a3e] mb-2\">\n                    {t(\"filters.category\", \"หมวดหมู่\")}\n                  </h3>\n                  <div className=\"flex flex-col gap-2\">\n                    {categoryTabs.map((tab) => (\n                      <button\n                        key={tab.id}\n                        onClick={() => setActiveSet(tab.id)}\n                        className={`text-left px-3 py-2 rounded-lg text-sm md:text-base font-medium transition ${\n                          activeSet === tab.id\n                            ? \"bg-[#5b4a3e] text-white shadow\"\n                            : \"hover:bg-black/5 text-[#5b4a3e]\"\n                        }`}\n                      >\n                        {tab.label}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              </aside>\n\n              {/* Content area */}\n              <main className=\"lg:col-span-3\">\n                {err ? (\n                  <div className=\"py-16 text-center text-red-600\">{err}</div>\n                ) : filtered.length === 0 ? (\n                  <div className=\"py-16 text-center\">\n                    {t(\"status.noResults\", \"ไม่พบหนังสือที่ตรงกับเงื่อนไข\")}\n                  </div>\n                ) : activeSet === \"all\" ? (\n                  <div className=\"space-y-12\">\n                    {Object.entries(groupedBySet)\n                      .filter(([key]) => key !== \"_none\")\n                      .map(([key, group]) => (\n                        <section key={key}>\n                          <ShelfTitle>\n                            {setLabels[key] ||\n                              `${t(\"books.collection\", \"คอลเลกชัน\")} #${key}`}\n                          </ShelfTitle>\n                          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\">\n                            {group.map((it) => (\n                              <BookCard\n                                key={it[\"o:id\"]}\n                                item={it}\n                                onOpen={openBook}\n                              />\n                            ))}\n                          </div>\n                          <ShelfBar />\n                        </section>\n                      ))}\n                    {groupedBySet[\"_none\"] && (\n                      <section>\n                        <ShelfTitle>\n                          {t(\"books.uncategorized\", \"ไม่ระบุหมวด\")}\n                        </ShelfTitle>\n                        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\">\n                          {groupedBySet[\"_none\"].map((it) => (\n                            <BookCard\n                              key={it[\"o:id\"]}\n                              item={it}\n                              onOpen={openBook}\n                            />\n                          ))}\n                        </div>\n                        <ShelfBar />\n                      </section>\n                    )}\n                  </div>\n                ) : (\n                  <section className=\"space-y-4\">\n                    <ShelfTitle>\n                      {setLabels[String(activeSet)] ||\n                        t(\"books.collection\", \"คอลเลกชัน\")}\n                    </ShelfTitle>\n                    <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-3\">\n                      {singleShelfItems.map((it) => (\n                        <BookCard\n                          key={it[\"o:id\"]}\n                          item={it}\n                          onOpen={openBook}\n                        />\n                      ))}\n                    </div>\n                    <ShelfBar />\n                  </section>\n                )}\n              </main>\n            </div>\n            <BackToTop />\n            <Footer />\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}