{"ast":null,"code":"// src/lib/omekaClient.js\nimport axios from\"axios\";/** ====== ENV & URL helpers ====== */const RAW_BASE=process.env.REACT_APP_API_BASE_URL||\"\";const BASE_URL=RAW_BASE.replace(/\\/+$/,\"\");export const withKeys=url=>{const key_identity=process.env.REACT_APP_API_KEY_IDENTITY;const key_credential=process.env.REACT_APP_API_KEY_CREDENTIAL;const sep=url.includes(\"?\")?\"&\":\"?\";return\"\".concat(url).concat(sep,\"key_identity=\").concat(key_identity,\"&key_credential=\").concat(key_credential);};export const api=path=>withKeys(\"\".concat(BASE_URL).concat(path.startsWith(\"/\")?path:\"/\".concat(path)));export const fetchJsonWithProxies=async finalUrl=>{try{const viaAllorigins=\"https://api.allorigins.win/get?url=\".concat(encodeURIComponent(finalUrl));const r1=await axios.get(viaAllorigins,{timeout:15000});return JSON.parse(r1.data.contents);}catch(_unused){}try{const viaCodetabs=\"https://api.codetabs.com/v1/proxy?quest=\".concat(encodeURIComponent(finalUrl));const r2=await axios.get(viaCodetabs,{timeout:15000});return r2.data;}catch(_unused2){}const r3=await axios.get(finalUrl,{timeout:15000});return r3.data;};/** ====== Small helpers ====== */export const titleOf=item=>{var _item$dctermsTitle,_item$dctermsTitle$;return item[\"o:title\"]||((_item$dctermsTitle=item[\"dcterms:title\"])===null||_item$dctermsTitle===void 0?void 0:(_item$dctermsTitle$=_item$dctermsTitle[0])===null||_item$dctermsTitle$===void 0?void 0:_item$dctermsTitle$[\"@value\"])||\"ไม่มีชื่อเอกสาร\";};export const descOf=item=>{var _item$dctermsAbstrac,_item$dctermsAbstrac$,_item$dctermsDescrip,_item$dctermsDescrip$;return((_item$dctermsAbstrac=item[\"dcterms:abstract\"])===null||_item$dctermsAbstrac===void 0?void 0:(_item$dctermsAbstrac$=_item$dctermsAbstrac[0])===null||_item$dctermsAbstrac$===void 0?void 0:_item$dctermsAbstrac$[\"@value\"])||((_item$dctermsDescrip=item[\"dcterms:description\"])===null||_item$dctermsDescrip===void 0?void 0:(_item$dctermsDescrip$=_item$dctermsDescrip[0])===null||_item$dctermsDescrip$===void 0?void 0:_item$dctermsDescrip$[\"@value\"])||\"\";};export const thumbOf=item=>{var _item$thumbnail_displ,_item$thumbnail_displ2,_item$thumbnail_displ3;return(item===null||item===void 0?void 0:(_item$thumbnail_displ=item.thumbnail_display_urls)===null||_item$thumbnail_displ===void 0?void 0:_item$thumbnail_displ.large)||(item===null||item===void 0?void 0:(_item$thumbnail_displ2=item.thumbnail_display_urls)===null||_item$thumbnail_displ2===void 0?void 0:_item$thumbnail_displ2.medium)||(item===null||item===void 0?void 0:(_item$thumbnail_displ3=item.thumbnail_display_urls)===null||_item$thumbnail_displ3===void 0?void 0:_item$thumbnail_displ3.square)||null;};export const createdOf=item=>{var _item$oCreated;const iso=item===null||item===void 0?void 0:(_item$oCreated=item[\"o:created\"])===null||_item$oCreated===void 0?void 0:_item$oCreated[\"@value\"];if(!iso)return\"-\";const d=new Date(iso);return d.toLocaleDateString(\"th-TH\",{year:\"numeric\",month:\"long\",day:\"numeric\"});};/** เปิด PDF ของรายการ */export async function openPDFOf(item){var _item$oPrimary_media;const mediaId=item===null||item===void 0?void 0:(_item$oPrimary_media=item[\"o:primary_media\"])===null||_item$oPrimary_media===void 0?void 0:_item$oPrimary_media[\"o:id\"];if(!mediaId)throw new Error(\"ไม่พบไฟล์หลักของรายการนี้\");const media=await fetchJsonWithProxies(api(\"/media/\".concat(mediaId)));const url=media===null||media===void 0?void 0:media[\"o:original_url\"];if(!url)throw new Error(\"ไม่พบ URL ของไฟล์ PDF\");window.open(url,\"_blank\");}","map":{"version":3,"names":["axios","RAW_BASE","process","env","REACT_APP_API_BASE_URL","BASE_URL","replace","withKeys","url","key_identity","REACT_APP_API_KEY_IDENTITY","key_credential","REACT_APP_API_KEY_CREDENTIAL","sep","includes","concat","api","path","startsWith","fetchJsonWithProxies","finalUrl","viaAllorigins","encodeURIComponent","r1","get","timeout","JSON","parse","data","contents","_unused","viaCodetabs","r2","_unused2","r3","titleOf","item","_item$dctermsTitle","_item$dctermsTitle$","descOf","_item$dctermsAbstrac","_item$dctermsAbstrac$","_item$dctermsDescrip","_item$dctermsDescrip$","thumbOf","_item$thumbnail_displ","_item$thumbnail_displ2","_item$thumbnail_displ3","thumbnail_display_urls","large","medium","square","createdOf","_item$oCreated","iso","d","Date","toLocaleDateString","year","month","day","openPDFOf","_item$oPrimary_media","mediaId","Error","media","window","open"],"sources":["C:/Users/Asus/Desktop/the-culture-read-cnx/src/lib/omekaClient.js"],"sourcesContent":["// src/lib/omekaClient.js\r\nimport axios from \"axios\";\r\n\r\n/** ====== ENV & URL helpers ====== */\r\nconst RAW_BASE = process.env.REACT_APP_API_BASE_URL || \"\";\r\nconst BASE_URL = RAW_BASE.replace(/\\/+$/, \"\");\r\n\r\nexport const withKeys = (url) => {\r\n  const key_identity = process.env.REACT_APP_API_KEY_IDENTITY;\r\n  const key_credential = process.env.REACT_APP_API_KEY_CREDENTIAL;\r\n  const sep = url.includes(\"?\") ? \"&\" : \"?\";\r\n  return `${url}${sep}key_identity=${key_identity}&key_credential=${key_credential}`;\r\n};\r\nexport const api = (path) =>\r\n  withKeys(`${BASE_URL}${path.startsWith(\"/\") ? path : `/${path}`}`);\r\n\r\nexport const fetchJsonWithProxies = async (finalUrl) => {\r\n  try {\r\n    const viaAllorigins = `https://api.allorigins.win/get?url=${encodeURIComponent(finalUrl)}`;\r\n    const r1 = await axios.get(viaAllorigins, { timeout: 15000 });\r\n    return JSON.parse(r1.data.contents);\r\n  } catch {}\r\n  try {\r\n    const viaCodetabs = `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(finalUrl)}`;\r\n    const r2 = await axios.get(viaCodetabs, { timeout: 15000 });\r\n    return r2.data;\r\n  } catch {}\r\n  const r3 = await axios.get(finalUrl, { timeout: 15000 });\r\n  return r3.data;\r\n};\r\n\r\n/** ====== Small helpers ====== */\r\nexport const titleOf = (item) =>\r\n  item[\"o:title\"] || item[\"dcterms:title\"]?.[0]?.[\"@value\"] || \"ไม่มีชื่อเอกสาร\";\r\n\r\nexport const descOf = (item) =>\r\n  item[\"dcterms:abstract\"]?.[0]?.[\"@value\"] ||\r\n  item[\"dcterms:description\"]?.[0]?.[\"@value\"] ||\r\n  \"\";\r\n\r\nexport const thumbOf = (item) =>\r\n  item?.thumbnail_display_urls?.large ||\r\n  item?.thumbnail_display_urls?.medium ||\r\n  item?.thumbnail_display_urls?.square ||\r\n  null;\r\n\r\nexport const createdOf = (item) => {\r\n  const iso = item?.[\"o:created\"]?.[\"@value\"];\r\n  if (!iso) return \"-\";\r\n  const d = new Date(iso);\r\n  return d.toLocaleDateString(\"th-TH\", { year: \"numeric\", month: \"long\", day: \"numeric\" });\r\n};\r\n\r\n/** เปิด PDF ของรายการ */\r\nexport async function openPDFOf(item) {\r\n  const mediaId = item?.[\"o:primary_media\"]?.[\"o:id\"];\r\n  if (!mediaId) throw new Error(\"ไม่พบไฟล์หลักของรายการนี้\");\r\n  const media = await fetchJsonWithProxies(api(`/media/${mediaId}`));\r\n  const url = media?.[\"o:original_url\"];\r\n  if (!url) throw new Error(\"ไม่พบ URL ของไฟล์ PDF\");\r\n  window.open(url, \"_blank\");\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}